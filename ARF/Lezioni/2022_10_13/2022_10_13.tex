\section{Lecture 13/10/2022}
\subsubsection*{Integration on product spaces}
\((X, \mathcal{M}, \mu), (Y, \mathcal{N},\nu)\) measure spaces. \(f : X \times Y \to \barreal\) measurable.

If \(f \geq 0\), then 
\[
    \iint_{X \times Y} f d\mu\otimes d\nu
\]
Goal: obtain a formula of iterated integral like the one in Analysis 2.

\(\forall \; \bar{x} \in X\) and \(\bar{y} \in Y\), we define
\[
    \begin{array}{llll}
        f_{\bar{x}} :& Y \to \barreal & f_{\bar{y}}:& X \to \barreal  \\
        & y \mapsto f(\bar{x}, y) & & x \mapsto f(x, \bar{y})

    \end{array}
\]
\begin{proposition}
    If \(f\) is measurable \(\Rightarrow\) \(f_{\bar{x}}\) is \((\mathcal{N}, \boreal)\)-measurable and \(f_{\bar{y}}\) is \((\mathcal{M}, \mathcal{B}(\barreal))\)-measurable.
    Then we can consider
    \[
        \begin{array}{ll}    
        \phi : X \to \barreal & 
        \phi(x) = \int_Y f_x d\nu = \int_Y f(x,y) \underbrace{d\nu(y)}_{dy} \\
        \psi : Y \to \barreal &
        \psi(y) = \int_X f_y d\mu = \int_X f(x,y) d\mu(x)
    \end{array}
    \]
\end{proposition}
\noindent\underline{Questions:} what is the solution of \(\iint_{X \times Y}\), \(\phi\) and \(\psi\)?

\begin{theorem}[Tonelli's theorem]
    \((X, \mathcal{M}, \mu)\) and \((Y, \mathcal{N}, \nu)\) complete measure spaces and \(\sigma\)-finite. \\
    Suppose that \(f\) is \((\mathcal{M} \otimes \mathcal{N}, \mathcal{B}(\barreal))\)-measurable and that \(f > 0\) a.e. on \(X \times Y\). Then \(\psi\) and \(\phi\) are measurable and
    \[
        \iint_{X \times Y} f d\mu \otimes d\nu = \int_X \phi(x) \, d\mu(x) = \int_Y \psi(y) \, d\nu(y) \tag*{Integration formula}
    \]
    Equally holds also if one of the integrals is \(\infty\).
    \[
        \begin{array}{l}
            \int_X \phi(x) \, d\mu(x) = \int_X \left(\int_Y f(x, y) \, d\nu(y) \right) \, d\mu(x) \\
            \int_Y \psi(y) \, d\nu(y) = \int_Y \left(\int_X f(x, y) \, d\mu(x) \right) \, d\nu(y)      
    \end{array}  
    \]
\end{theorem}
\begin{remark}
    The double integral can be reduced to single integrals, iterated. Moreover we can always change the order of the integrals.
    For sign changing functions the situation is more involved.
\end{remark}
\begin{theorem}[Fubini's theorem]
    \((X, \mathcal{M}, \mu)\) and \((Y, \mathcal{N}, \nu)\) complete measure spaces and \(\sigma\)-finite.
    If \(f \in L^1(X \times Y)\), then \(\psi\) and \(\phi\) defined above are measurable, the integration formula holds, and all the integrals are finite.
\end{theorem}
\noindent\underline{Question}: how to check if \(f\in L^1(X \times Y)\)? Typically, to check that \(f \in L^1(X \times Y)\) one uses Tonelli: 
\[
    f \in L^1(X \times Y) \Leftrightarrow \iint_{X \times Y} \abs{f} \, d\mu \otimes d\nu
\]
We use Tonelli to check that this is finite. 
If \(\iint_{X \times Y} \vert f \vert d\mu \otimes d\nu < \infty\) then we can apply Fubini for \(\iint_{X \times Y} f d\mu \otimes d\nu\)
\begin{remark}
    the proof of Fubini's and Tonelli's theorems is based for the iterated integrals for characteristic functions.
    Note that 
    \[(\mu \otimes \nu)(E) = \begin{array}{l}
        \int_X \phi(x) \, d\mu(x) = \int_X \left(\int_Y f(x, y) \, d\nu(y) \right) \, d\mu(x) \\
        \int_Y \psi(y) \, d\nu(y) = \int_Y \left(\int_X f(x, y) \, d\mu(x) \right) \, d\nu(y)
    \end{array}
    \]
\end{remark}
\begin{remark}
    Sometimes double integrals are very useful to compute single integrals.
\end{remark}
Ex: \(\int_{-\infty}^{+\infty}e^{-x^2} = \sqrt{\pi}\)



