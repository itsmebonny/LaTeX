\documentclass[a4paper,11pt]{article}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{hhline}
\usepackage{hyperref}
\usepackage{mathtools}
\usepackage{bm}
\usepackage[margin=2cm]{geometry}

\usepackage{amsthm}

\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{physics}
\usepackage{textcomp}

\usepackage{mdframed}
\usepackage{xcolor}

\usepackage[makeroom]{cancel}
\usepackage{mathrsfs}

\usepackage[many]{tcolorbox}


\setlength\parindent{0pt}

\newlength\mylength
\setlength\mylength{0.1cm}
\newcolumntype{Y}{>{\Centering\arraybackslash}X}
\newtheoremstyle{break}
  {\partopsep}{\topsep}%  
  {\normalfont}{}
  {\bfseries}{}%
  {\newline}{}%
  \theoremstyle{break}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{remark}{Remark}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{notation}{Notation}[section]
\newtheorem{definition}{Definition}[section]


\tcolorboxenvironment{theorem}{
  breakable,
  colback=purple!30,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=5pt,bottom=5pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{corollary}{
  breakable,
  colback=blue!15!white,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{proposition}{
  breakable,
  colback=blue!15!white,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{lemma}{
  breakable,
  colback=pink,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{remark}{
  breakable,
  colback=orange!15!white,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{notation}{
  breakable,
  colback=green!150!black!50,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}
\tcolorboxenvironment{definition}{
  breakable,
  colback=yellow!70!,
  boxrule=0pt,
  boxsep=1pt,
  left=2pt,right=2pt,top=2pt,bottom=2pt,
  oversize=2pt,
  before skip=\topsep,
  after skip=\topsep,
}

\renewcommand*{\proofname}{\textbf{Proof}}
\renewcommand\qedsymbol{$\bigstar$}
\renewcommand*{\grad}{\nabla\mspace{1mu}}
\renewcommand*{\div}{\text{div}\mspace{1mu}}
\newcommand{\rot}{\text{rot}\mspace{1mu}}
\renewcommand\labelenumi{(\theenumi)}
\newcommand{\vect}[1]{\textbf{#1}}

\let\oldemptyset\emptyset
\let\emptyset\varnothing
\let\oldepsilon\epsilon
\let\epsilon\varepsilon
\let\oldphi\phi
\let\phi\varphi

\newcommand*{\txt}[1]{\text{#1}}

\newcommand{\ind}{\perp\!\!\!\!\perp} 
\newcommand{\measurespace}{(X, \mathcal{M}, \mu)}
\newcommand{\sigalg}{\sigma\mbox{-algebra}}
\newcommand{\boreal}{\mathcal{B}(\mathbb{R})}
\renewcommand{\real}{\mathbb{R}}
\renewcommand{\natural}{\mathbb{N}}
\newcommand{\barreal}{\overline{\mathbb{R}}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\xdownarrow}[1]{%
  {\left\downarrow\vbox to #1{}\right.\kern-\nulldelimiterspace}
}
\newcommand{\xuparrow}[1]{%
  {\left\uparrow\vbox to #1{}\right.\kern-\nulldelimiterspace}
}
\newcommand{\arrvline}{\hfil\kern\arraycolsep\vline\kern-\arraycolsep\hfilneg}
\newcommand{\esssup}{\text{ess}\, \text{sup}}
\newcommand{\normdot}{\norm{\cdot}}
\newcommand{\scalardot}{\langle \cdot,\cdot \rangle}
\newcommand{\scalarproduct}[2]{\langle #1,#2 \rangle}
\newcommand*{\limited}[1]{\vert_{#1}}
\newcommand{\interior}[1]{%
 {\kern0pt#1}^{\mathrm{o}}%
}
\newcommand*{\seminorm}[2]{\left\lvert#1\right\rvert_{#2}}
\newcommand*{\threenorm}[3][\null]{\left\lvert\mspace{-2mu}\left\lvert\mspace{-2mu}\left\lvert#2\right\rvert\mspace{-2mu}\right\rvert\mspace{-2mu}\right\rvert_{#3}^{#1}}

\newcommand{\ltwonorm}[1]{\norm{#1}_{L^2(\Omega)}}
\newcommand{\honenorm}[1]{\norm{#1}_{H^1(\Omega)}}

\newcommand{\jump}[1]{\left[\!\left[#1\right]\!\right]}
\newcommand{\average}[1]{\left\{\mspace{-6.5mu}\left\{#1\right\}\mspace{-6.5mu}\right\}}

\newcommand{\element}{\mathcal{K}}
\newcommand{\triangulation}{\mathcal{T}_h}

\newcommand{\boundary}{{\partial\Omega}}
\newcommand{\eit}{{\element\in\triangulation}}
\newcommand{\scalingfactor}{\tau_{\element}}
\newcommand{\peclet}{\mathbb{P}e}

\newcommand{\vecbabs}{\abs{\vect{b}}}
\newcommand{\loperator}{\mathcal{L}}
\newcommand{\xvec}{\vect{x}}
\newcommand{\tstep}{\Delta t}
\newcommand{\onehalf}{\frac{1}{2}}
\newcommand{\bilinear}{a(\cdot, \cdot)}
\newcommand{\uvec}{\vect{u}}
\newcommand{\normal}{\vect{n}}
\newcommand{\vvec}{\vect{v}}
\newcommand{\honed}{\left[ H^1(\Omega) \right]^d}
\newcommand{\find}{\txt{find }}

\newmdenv[backgroundcolor=blue!20]{background}


\def\stackbelow#1#2{\underset{\displaystyle\overset{\displaystyle\shortparallel}{#2}}{#1}}
\def\stackbelowlittle#1#2{\underset{\textstyle\overset{\textstyle\shortparallel}{#2}}{#1}}



\long\def\symbolfootnotemark[#1]#2{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnotetext[#1]{#2}\footnotemark[#1]\endgroup}

\long\def\symbolfootnotetext[#1]#2{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnotetext[#1]{#2}\endgroup}


\numberwithin{equation}{section}





\begin{document}
\title{Reminders for NAPDE}
\author{Andrea Bonifacio}
\date{\today}
\maketitle
\section*{Reminders on calculus}
\[
    \int_\Omega-\Delta u v = \int_\Omega \grad u \cdot \grad v - \underbrace{\int_{\boundary}  \grad u \cdot \vect{n} v}_{= 0 \txt{ if } v\vert_{\boundary} = 0}
\]
\[
    \int_\Omega \div u = \int_\boundary u \cdot \vect{n} 
\]
\[
    -\int_\Omega \vect{v} \cdot \grad p = \int_\Omega p\div \vect{v} + \int_\boundary \vvec \cdot \normal p
\]
\[
    \int_\Omega \pderivative{x}u^2 = \onehalf \int_\boundary u\cdot \normal  
\]
\subsection*{Lifting Operators}
If \(u\) on \(\boundary\) is non-null, we need to solve this problem, otherwise we cannot use test functions that vanish at the boundary. To do so, given \(u = g \txt{ on }\boundary\) we use a lifting operator \(Rg \in H^1(\Omega) : Rg\limited{\boundary} = g\), and modify our solution such that \(u = \overset{\mathrm{o}}{u} + Rg\), so the function \(\overset{\mathrm{o}}{u}\) has the properties we need. We then look for bilinear formulation such as \(a(\overset{\mathrm{o}}{u}, v)\) and add to the right-hand side \(-a(Rg, v)\).
\section*{Weak Formulations}
\subsection*{Elliptic equations}
\begin{equation*}
    \begin{cases}
        -\div(\mu \grad u)+ \vect{b}\cdot \grad u + \sigma u = f& \text{in } \Omega \quad g \in L^2(\Gamma_N) \\
        u = 0 & \txt{on }\Gamma_D \quad \partial\Omega = \Gamma_D \cup \Gamma_N \\

        \mu \grad u \cdot \vect{n} = g & \txt{on } \Gamma_N \quad \interior{\Gamma_D} \cap \interior{\Gamma_N} = \emptyset
    \end{cases}
\end{equation*}
\[
    \Downarrow
\]
\begin{equation*}
    \underbrace{\int_\Omega \mu\grad u \cdot \grad v  + \int_\Omega \vect{b} \cdot \grad u v + \int_\Omega \sigma u v}_{=: a(u,v)} = \int_\Omega f v +\underbrace{\int_{\Gamma_D} \mu \grad u \cdot \vect{n} v}_{= 0 \txt{ if } v\vert_{\Gamma_D} = 0} + \int_{\Gamma_N} \underbrace{\mu \grad u \cdot \vect{n}}_{= g} v 
\end{equation*}
\[
    \Downarrow
\]
\begin{equation*}
    \begin{cases}
        \find u \in V & V = \left\{v \in H^1(\Omega), v\vert_{\Gamma_D} = 0\right\} =: H^1_{\Gamma_D}(\Omega)\\
        a(u,v) = \scalarproduct{F}{v} & \forall \; v \in V \label{Weak Formulation of Boundary Value Problems}
    \end{cases}
\end{equation*}
\subsection*{Parabolic equations}
\begin{equation*}
    \begin{cases}
        \partialderivative{u}{t} - \nu \partialderivative{^2u}{x^2} = f & 0 < x <d, t> 0 \\
        u(x,0) = u_0(x) & 0 < x < d \\
        u(0,t) = u(d,t) = 0 & t>0
    \end{cases}
    \label{one_dim_pbl}
\end{equation*}
\[
    \Downarrow
\]
\begin{equation*}
    \int_{\Omega} \partialderivative{u(t)}{t} v \, d\Omega + a(u(t), v) = \int_\Omega f(t)v \, d\Omega \quad \forall \; v \in V 
    \label{weak_formulation_heat_pbl}
\end{equation*}
\[
    \Downarrow
\]
for each \(t > 0\), we need to find \(u_h(t) \in V_h\) s.t. 
\begin{equation*}
    \int_\Omega \partialderivative{u_h(t)}{t} v_h \, d\Omega + a(u_h(t), v_h) = \int_\Omega f(t)v_h \, d\Omega \quad \forall \; v_h \in V_h
\label{semi-discretization_pbl}
\end{equation*}
\subsection*{Discontinuous Galerkin}
\begin{equation*}
    \begin{cases}
        -\Delta u = f & \txt{in }\Omega \\
        u = 0 & \txt{on }\boundary
    \end{cases}
\end{equation*}
\[
    \Downarrow
\]
\[
    \sum_{\eit}\int_\element \grad u \cdot \grad v - \sum_\eit \int_{\boundary\element} \grad u \cdot \normal_\element v = \int_\Omega fv
\]
\[
    \Downarrow
\]
\begin{equation*}
    \sum_{\eit} \int_{\boundary\element} u \cdot \normal_\element v = \sum_{F \in \mathcal{F}} \int_F \average{u} \cdot \jump{v} + \sum_{F \in \mathcal{F}'_h} \int_F \jump{u}\average{v} \tag*{Magic formula}
\end{equation*}
\[\Downarrow\]
\begin{equation*}
    \begin{split}
        \sum_\eit \int_\element \grad u \grad v - \sum_{F \in \mathcal{F}_h} \int_F \average{\grad u} \cdot \jump{v} 
        -\theta \sum_{F \in \mathcal{F}_h} \int_F \jump{u} \cdot \average{\grad_h v} + \sum_{F \in \mathcal{F}_h} \int_F \gamma \jump{u} \cdot \jump{v} = \int_\Omega fv
    \end{split}
\end{equation*}
\section*{Numerical formulation}
\subsection*{Continuous Galerkin}
Space \(V_h = \left\{ v_h \in \mathcal{C}^0(\overline{\Omega}) : v_h\limited{\element} \in \mathbb{P}^r(\element) \ \forall \; \eit, v_h\limited{\Gamma_D} = 0 \right\}\)
\[
    \find u_h \in V_h : a(u_h,v_h) = F(v_h) \quad \forall \; v_h \in V_h
\]
\subsection*{GLS}
\[
    \find u_h \in V_h : a(u_h, v_h) + \sum_{\element \in \triangulation} \int_\Omega \mathcal{L}u_h \tau_\element \mathcal{L}v_h = \int_\Omega f v_h + \sum_{\element \in \triangulation} \int_\Omega f \tau_\element \mathcal{L}v_h \qquad \forall \; v_h \in V_h
\]
\subsection*{Discontinuous Galerkin}
Space \(V^p_h = \left\{ v_h \in L^2(\Omega) : v_h\limited{\element} \in \mathbb{P}^{p_\element}(\element) \ \forall \eit \right\}\not \subseteq H^1_0(\Omega)\)
\[
    \find u_h \in V^p_h : \mathcal{A}(u_h, v_h) = \int_\Omega fv_h \quad \forall \; v_h \in V_h^p
\]
where 
\[
    \begin{split}
        \mathcal{A}(u,v) = \sum_\eit \int_\element \grad u \grad v - \sum_{F \in \mathcal{F}_h} \int_F \average{\grad_h u} \cdot \jump{v} \\
        -\theta \sum_{F \in \mathcal{F}_h} \int_F \jump{u} \cdot \average{\grad_h v} + \sum_{F \in \mathcal{F}_h} \int_F \gamma \jump{u} \cdot \jump{v}
    \end{split}
\]
\begin{itemize}
    \item \(\theta = 1\) Symmetric interior penalty
    \item \(\theta = -1\) Non-symmetric interior penalty
    \item \(\theta = 0\) Incomplete interior penalty
    \item \(\gamma = \alpha \frac{p^2}{h}\)
\end{itemize}
In the case of Dirichlet B.C. \(u = g\) on \(\boundary\) modify r.h.s. and introduce the set of boundary faces \(\mathcal{F}^B_h\)
\[
    \int_\Omega fv - \theta \sum_{F \in \mathcal{F}^B_h} \int_F g \grad_h v \cdot n + \sum_{F \in \mathcal{F}^B_h} \int_F \gamma g v 
\]
In case of Neumann B.C. \(\grad u \cdot n = g\) on \(\boundary\) we introduce the set of interior faces \(\mathcal{F}'_h\)
\[
    \begin{split}
        \mathcal{A}(u,v) = \sum_\eit \int_\element \grad u \grad v - \sum_{F \in \mathcal{F}'_h} \int_F \average{\grad_h u} \cdot \jump{v} \\
        -\theta \sum_{F \in \mathcal{F}'_h} \int_F \jump{u} \cdot \average{\grad_h v} + \sum_{F \in \mathcal{F}'_h} \int_F \gamma \jump{u} \cdot \jump{v}
    \end{split}
\]
and 
\[
    \int_\Omega fv + \sum_{F \in \mathcal{F}^B_h} \int_F g v 
\]
\subsection*{SEM}
Space \(\mathbb{Q}_N(I) = \left\{ v(x) = \sum_{k=0}^{N} a_k x^k, \ a_k \in \real \right\}\)

In one dimension \(\mathbb{Q}_N = \mathbb{P}_N\)

Space \(V_N = \left\{ v_N \in \mathbb{Q}_N : v_N\limited{\Gamma_D} = g \right\}\)

If the domain is meshed \(V_N = \left\{ v_N \in \mathcal{C}^0(\overline{\Omega}): v_N\limited{\element} \mathrm{o} \bm{\phi}_k \in \mathbb{Q}_N(\hat{\element}) \ \forall \; \eit \right\}\)
\[
    \find u_N \in V_N: a(u_N, v_N) = (F, v_N)_{L^2(\Omega)} \quad \forall \; v_N \in V_N
\]
\subsection*{Galerkin-NI}
Space \(V_N = \left\{ v_N \in \mathbb{P}_N(\Omega) : v\limited{\Gamma_D} = g \right\}\)
\[
    \find u_N \in V_N : a_N(u_N,v_N) = f_N(v_N) \quad \forall \; v_N \in V_N
\]
\subsection*{SEM-NI}
Space \(X_\delta= \left\{ v_\delta \in \mathcal{C}^0(\Omega) : v_\delta\limited{\element} = \hat{v}_\delta \, \mathrm{o}\, \vect{F}^{-1}_\element, \txt{ with } \hat{v}_\delta \in \mathbb{Q}_p(\hat{\element}) \ \forall \; \eit \right\}\)
\[
    \find u_\delta \in X_\delta : a_\delta(u_\delta, v_\delta) = F_\delta(v_\delta) \quad \forall \; v_\delta \in X_\delta
\]
\section*{Stability}
\subsection*{Continuous Galerkin}
\[
    \norm{u_h} \leq \frac{\norm{F}_{V'}}{\alpha}
\]
\subsection*{Stabilized Galerkin}
\[
    \norm{u_h}_{GLS}^2 \leq C \norm{f}_{L^2(\Omega)}^2
\]
Also \(\tau_\element\)
\[
    \tau_\element(\xvec) = \delta\frac{h_\element}{\abs{\vect{b}(\xvec)}} \quad \tau_\element(\xvec) = \frac{h_\element}{2\abs{\vect{b}(\xvec)}} \epsilon(\peclet_\element)
\]
\subsection*{Parabolic equations}
Stability of \(\theta\)-method for \(\theta <\onehalf\) 
\[
    \exists \; c > 0: \tstep \leq ch^2 \quad \forall \; h > 0
\]
or even 
\[
    \tstep \leq \frac{2}{(1-2\theta)\lambda_h^{N_h}}
\]
where \(\lambda_h^{N_h}\) is the largest eigenvalue of the bilinear form.
\subsection*{Discontinuous Galerkin}
Introduce broken Sobolev space
\[
    H^s(\triangulation) = \left\{ v \in L^2(\Omega) : v\limited{\element} \in H^s(\element) \ \forall \; \eit \right\}
\]
and the norms 
\begin{align*}
    &\norm{v}^2_{H^s(\triangulation)} = \sum_{\eit} \norm{v}^2_{H^s(\element)} &\norm{v}^2_{L^2(\mathcal{F}_h)} = \sum_{F \in \mathcal{F}} \norm{v}^2_{L^2(F)} \\ 
    &\norm{v}^2_{DG} = \ltwonorm{\grad_h v}^2 + \norm{\sqrt{\gamma}\jump{v}}^2_{L^2(\mathcal{F}_h)} &\threenorm[2]{v}{DG} = \norm{v}^2_{DG} + \norm{\frac{1}{\sqrt{\gamma}} \average{\grad_h v}}^2_{L^2(\mathcal{F}_h)}
\end{align*}
And some key properties to stability
\begin{itemize}
    \item Continuity on \(H^2(\triangulation) \times V_h^p\)
    \[
        \abs{\mathcal{A}(u, v_h)} \lesssim \threenorm{u}{DG} \norm{v_h}_{DG} \quad \forall \; u \in H^2(\triangulation), \forall \; v_h \in V_h^p 
    \]
    \item Coercivity on \(V_h^p \times V_h^p\) 
    \[
        \mathcal{A}(v_h, v_h) \gtrsim \norm{v}^2_{DG} \quad \forall \; v_h \in V_h^p
    \]
    \item  Strong-consistency (Galerkin orthogonality):
    \[
        \mathcal{A}(u,v_h) = \int_\Omega f v_h \ \ \forall \; v_h \in V_h^p \Rightarrow \mathcal{A}(u-u_h, v_h) = 0 \quad \forall \; v_h \in V_h^p
    \]
    \item Approximation. Let \(\prod_{h}^{p}u \in V_h^p\) be a suitable approximation of \(u\), then 
    \[
        \threenorm{u-{\textstyle \prod_{h}^{p}u}}{DG} \lesssim \frac{h^{\min(p,s)}}{p^{s-\frac{1}{2}}}\norm{u}_{H^{s+1}(\triangulation)}
    \]
    If \(p \geq s\)
    \[
        \threenorm{u-{\textstyle \prod_{h}^{p}u}}{DG} \lesssim \left( \frac{h}{p} \right)^s p^{\frac{1}{2}}\norm{u}_{H^{s+1}(\triangulation)}
    \]
\end{itemize}
\subsection*{Spectral Methods}
Strang Lemma 
\[
    \norm{v_h}_V \leq \frac{1}{\alpha^*} \sup_{v_h \in V_h \setminus \left\{ 0 \right\}} \frac{F_h(v_h)}{\norm{v_h}_V}
\]
\section*{Convergence rates}
\subsection*{Galerkin} 
Ceà Lemma 
\[
    \norm{u-u_h} \leq \frac{M}{\alpha} \inf_{v_h \in V_H} \norm{u-v_h}
\]
\[
    \norm{u- \textstyle \prod_{h}^{r}u} \leq C h^r\seminorm{u}{H^{r+1}(\Omega)}
\]
\subsection*{Stabilized Galerkin}
If 
\[
    \peclet_\element(\xvec) = \frac{\abs{\vect{b}(\xvec)} h_\element}{2\mu} > 1 \quad \forall \; \xvec \in \element
\]
then 
\[
    \norm{u - u_h}_{GLS} \leq Ch^{r+\onehalf} \seminorm{u}{H^{r+1}(\Omega)}
\]
\subsection*{Parabolic equations}
\begin{equation*}
    \begin{split}
        \left\{ \ltwonorm{u(t) - u_h(t)}^2 + \alpha \int_0^t \ltwonorm{\grad u(s) -\grad u_h(s)}^2 \, ds \right\}^{\onehalf} \\
        \leq Ch^r \left\{ \seminorm{u_0}{H^r(\Omega)}^2 + \int_0^t \seminorm{u(s)}{H^{r+1}( Omega)}^2 \, ds + \int_0^t \seminorm{\partialderivative{u(s)}{s}}{H^{r+1}(\Omega)}^2 \, ds \right\}^{\onehalf}
    \end{split}
\end{equation*}
\subsection*{Galerkin-NI}
\[
    \norm{u-u_N^{\txt{GNI}}}_{H^1(\Omega)} \leq C(s) \left(\frac{1}{N}\right)^s \left(\norm{u}_{H^{s+1}(\Omega)}+\norm{f}_{H^s(\Omega)}\right)
\]
\subsection*{SEM-NI}
\[
    \norm{u - u_\delta}_{H^1(\Omega)} \leq C(s) \left( h^{\min(p,s)} \left( \frac{1}{p} \right)^s \norm{u}_{H^{s+1}} + h^{\min(p,r)}\left( \frac{1}{p} \right)^r \norm{f}_{H^r(\Omega)} \right)
\]
\subsection*{Discontinuous Galerkin}
Interpolation error 
\[
    \threenorm{u-\textstyle\prod_h^p u}{DG} \lesssim \frac{h^{\min(p,s)}}{p^{s-\onehalf}}\norm{u}_{H^{s+1}(\triangulation)}
\]
And, since \( \norm{u-u_h}_{DG} \lesssim \threenorm{u-\textstyle\prod_h^p u}{DG}\):

General (if \(\alpha\) large enough for SIP and NIP):
\[
    \norm{u-u_h}_{DG} \lesssim \frac{h^{\min(p,s)}}{p^{s-\onehalf}}\norm{u}_{H^{s+1}(\triangulation)}
\]
\(L^2\) norm (if \(\Omega\) is a convex domain):
\begin{itemize}
    \item SIP \(\theta = 1\)
    \[
        \ltwonorm{u-u_h} \lesssim \frac{h^{\min(p,s)+1}}{p^{s+\onehalf}}\norm{u}_{H^{s+1}(\triangulation)}
    \]
    \item NIP \(\theta = -1\) and IIP \(\theta = 0\)
    \[
        \ltwonorm{u-u_h} \lesssim \frac{h^{\min(p,s)}}{p^{s-\onehalf}}\norm{u}_{H^{s+1}(\triangulation)}
    \]
\end{itemize}
\subsection*{Navier-Stokes}
In case of inf-sup (LBB) condition satisfied by \(V\) and \(Q\)
\[
    \norm{\uvec-\uvec_h}_V + \norm{{p}-{p}_h}_Q \leq C(\alpha_h, \beta_h, \gamma, \delta)\left\{ \inf_{\vvec_h \in V_h}\norm{\uvec-\vvec_h}_V + \inf_{{q}_h \in Q_h}\norm{{p}-{q}_h}_Q \right\}
\]
where 
\begin{itemize}
    \item \(\alpha_h\) is the coercivity constant on the subspace \(V_h\) of divergence free velocities
    \item \(\beta_h\) is the LBB constant 
    \item \(\gamma\) is the continuity constant of \(\bilinear\)
    \item \(\delta\) is the continuity constant of \(b(\cdot,\cdot)\)
\end{itemize}
In case of Taylor-Hoods elements 
\[
    \norm{\uvec-\uvec_h}_V + \norm{{p}-{p}_h}_Q \leq Ch(\norm{\uvec}_{H^{k+1}} + \norm{p}_{H^k})
\]
\section*{Code implementation}
\subsection*{CG-FEM}
\begin{itemize}
    \item Matrix \(A\);
    \[
        A_{ij} = \int_\Omega \grad \phi_j \grad \phi_i  
    \]
    Loop on all the elements and compute locally (elements with \(\hat{\cdot}\) are computed on the reference element):
    \[
        A_{loc_{ij}} = \det(\vect{B}_\element) \int_{\hat{\element}} \hat{\grad} \hat{\phi}^T_j \vect{B}_\element^{-1} \vect{B}^{-1}_\element \hat{\grad} \hat{\phi}_i = \frac{\det(\vect{B})}{2} \hat{\grad} \hat{\phi}^T_j \vect{B}_\element^{-1} \vect{B}^{-T}_\element \hat{\grad} \hat{\phi}_i
    \]
    Can be implemented as 
    \begin{verbatim}
        function [K_loc]=C_lap_loc(Grad,w_2D,nln,BJ)
        K_loc=zeros(nln,nln);
        for i=1:nln
            for j=1:nln
                for k=1:length(w_2D)
                    Binv = inv(BJ(:,:,k));   % inverse
                    Jdet = det(BJ(:,:,k));   % determinant 
                    K_loc(i,j) = K_loc(i,j) + (Jdet.*w_2D(k)) .* ( (Grad(k,:,i)
                                 * Binv) * (Grad(k,:,j) * Binv )');
                end
            end
        end
    \end{verbatim}
    or (use this if P1)
    \begin{verbatim}
        for i=1:nln
            for j=1:nln
                    Binv = inv(BJ(:,:,1));   % inverse
                    Jdet = det(BJ(:,:,1));   % determinant 
                    K_loc(i,j) = K_loc(i,j) + 0.5 * Jdet 
                    *  Grad(1,:,i) * Binv * Binv' * Grad(1,:,j)';
            end
        end
    \end{verbatim}
    \item Mass matrix \(M\):
    \[
        M_{ij} = \int_\Omega \phi_j, \phi_i
    \]
    Loop on all the elements and calculate the local mass matrix
    \[
        M_{loc_{ij}} =  \det(\vect{B}_\element) \int_{\hat{\element}} \hat{\phi}_j \hat{\phi}_i
    \]
    Can be implemented as
    \begin{verbatim}
        function [M_loc]=C_mass_loc(dphiq,w_2D,nln,BJ)
        M_loc=zeros(nln,nln);
        for i=1:nln
            for j=1:nln
                for k=1:length(w_2D)
                    Jdet = det(BJ(:,:,k));      % determinant 
                    M_loc(i,j) = M_loc(i,j) + (Jdet.*w_2D(k))
                                 .* dphiq(1,k,i).* dphiq(1,k,j);
                end
            end
        end
    \end{verbatim}
    \item Transport matrix \(T\)
    
    Can be implemented as 
    \begin{verbatim}
        function [ADV_loc]=C_adv_loc(Grad,dphiq,beta,w_2D,nln,BJ)
        ADV_loc=sparse(nln,nln);
        for i=1:nln
            for j=1:nln
                for k=1:length(w_2D)
                    Binv=inv(BJ(:,:,k));    % inverse
                    Jdet=det(BJ(:,:,k));    % determinant 
                    ADV_loc(i,j) = ADV_loc(i,j)+(Jdet.*w_2D(k)).* dphiq(1,k,i)
                                   *( (beta)*(Grad(k,:,j) * Binv )');
                end
            end
        end
    \end{verbatim}
    \item Right-hand side \(\vect{b}\):
    \[
        b_i = \int_\Omega f\phi_i
    \]
    which is computed 
    \begin{verbatim}
        function [f]=C_loc_rhs2D(force,dphiq,BJ,w_2D,pphys_2D,nln,mu)
        f = zeros(nln,1);
        x = pphys_2D(:,1);
        y = pphys_2D(:,2);
        F = eval(force);
        for s = 1:nln
            for k = 1:length(w_2D)
                Jdet = det(BJ(:,:,k));  % determinant 
                f(s) = f(s) + w_2D(k)*Jdet*F(k)*dphiq(1,k,s);
            end    
        end
    \end{verbatim}
\end{itemize}
\end{document}