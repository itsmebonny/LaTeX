\newpage 
\section{Navier-Stokes equations}
\subsection{Introduction}
Navier-Stokes equations describe the motion of a fluid with constant density \(\rho\) in a domain \(\Omega \subset \real^d\) with \(d = 2,3\). They read as follows
\begin{equation}
    \begin{cases}
        \displaystyle \partialderivative{\uvec}{t} - \div \left[ \nu \left( \grad \uvec + \grad \uvec^T \right) \right] + \left( \uvec \cdot \grad \right) \uvec + \grad p = \vect{f} & \xvec \in \Omega, \ t > 0 \\
        \div \uvec = 0 & \xvec \in \Omega, \ t > 0
    \end{cases}
    \label{navier_stokes_fake_ns}
\end{equation}
where 
\begin{itemize}
    \item \(\uvec\) is the fluid's velocity
    \item \(p\) is the pressure divided by the density (which will be simply called ``pressure'')
    \item \(\nu\) is the kinematic viscosity 
    \item \(\vect{f} \in L^2(\real^+; [L^2(\Omega)]^d)\) is a forcing term per unit of mass
\end{itemize}
The first equation represents conservation of linear momentum, while the second one the conservation of mass. In fact, the term \(\left( \uvec \cdot \grad \right)\uvec\) describes the process of convective transport, while the term \(-\div \left[ \nu \left( \grad \uvec + \grad \uvec^t \right) \right]\) describe the process of molecular diffusion.

When \(\nu\) is constant, from the continuity equation we obtain 
\[
    \div \left[ \nu \left( \grad \uvec + \grad \uvec^T \right) \right] = \nu \left( \Delta \uvec +\grad \div u \right) = \nu\Delta \uvec
\]
and system \eqref{navier_stokes_fake_ns} can be rewritten as 
\begin{equation}
    \begin{cases}
        \displaystyle \partialderivative{\uvec}{t} - \nu \Delta \uvec + \left( \uvec \cdot \grad \right) \uvec + \grad p = \vect{f} & \xvec \in \Omega, \ t > 0 \\
        \div\uvec = 0 & \xvec \in \Omega, \ t > 0
    \end{cases}
    \label{navier_stokes_ns}
\end{equation}
The \eqref{navier_stokes_ns} are often called incompressible Navier-Stokes equations. More in general, when \(\div\uvec = 0\), fluids are said to be incompressible. 

In order for \eqref{navier_stokes_ns} to be well posed, it is necessary to assign the initial condition 
\begin{equation}
    \uvec(\xvec, 0) = \uvec_0(\xvec) \quad \forall \; \xvec \in \Omega
    \label{initial_condition_ns}
\end{equation}
where \(\uvec_0\) is a given divergence-free vector field. Then we would need suitable BC
\begin{equation}
    \begin{cases}
        \uvec(\xvec, t) = \bm{\phi}(\xvec, t) & \forall \; \xvec \in \Gamma_D, \ t > 0 \\
        \displaystyle \left( \nu \partialderivative{\uvec}{\vect{n}} - p\normal  \right)\left( \xvec, t \right) = \bm{\psi}(\xvec, t) & \forall \; \xvec \in \Gamma_N, \ t > 0 
    \end{cases}
    \label{boundaries_ns}
\end{equation}
where \(\bm{\phi}\) and \(\bm{\psi}\) are given vector functions, while \(\Gamma_D\) and \(\Gamma_N\) provide a partition of the boundary, such that \(\Gamma_D \cup \Gamma_N = \boundary, \interior{\Gamma}_D \cap \interior{\Gamma}_N =\emptyset\).
Finally, as usual \(\normal\) is the outward unit normal vector to \(\boundary\).

If we denote with \(u_i, i = 1,\ldots, d\) the components of \(\uvec\) w.r.t. a Cartesian frame, and, likewise, with \(f_i\) components of \(\vect{f}\), we obtain, from \eqref{navier_stokes_ns}
\[
    \begin{cases}
        \displaystyle \partialderivative{u_i}{t} - \nu \grad u_i + \sum_{j=1}^{d} u_j\partialderivative{u_i}{x_j} + \partialderivative{p}{x_j} = f_i & i = 1,\ldots, d \\
        \displaystyle \sum_{j=1}^{d} \partialderivative{u_j}{x_j} = 0
    \end{cases}
\]
\begin{remark}
    The Navier-Stokes equations have been written in terms of the primitive variable \(\uvec\) and \(p\), but other sets of variables may be used too. For instance, in the two-dimensional case it is common to see the vorticity \(\omega\) and the streamfunction \(\psi\) that are related to the velocity
    \begin{equation*}
        \omega =\rot\uvec = \partialderivative{u_2}{x_1} - \partialderivative{u_1}{x_2}, \quad \uvec = \left[ \begin{matrix*}
            \partialderivative{\psi}{x_2} \\
            -\partialderivative{\psi}{x_1}
        \end{matrix*} \right].
    \end{equation*}
    The various formulations are equivalent from a mathematical standpoint, but may give rise to different numerical methods.
\end{remark}
\subsection{Weak formulation}
A weak formulation of the problem can be obtained as usual, by multiplying a test function \(\vect{v}\), belonging to a suitable space \(V\), and integrate in \(\Omega\)
\begin{equation}
    \begin{split}
        \int_\Omega \partialderivative{\uvec}{t} \cdot \vvec \, d\Omega - \int_\Omega \nu \Delta \uvec \cdot \vvec \, d\Omega + \int_\Omega \left[ \left( \uvec \cdot \grad \right) \uvec \right] \cdot \vvec \, d\Omega + \int_\Omega \grad p \cdot \vvec \, d\Omega 
        = \int_\Omega \vect{f} \cdot \vvec \, d\Omega
    \end{split}
\end{equation}
Using Green's formula we find 
\begin{align*}
    -\int_\Omega \nu \Delta \uvec \cdot \vvec \, d\Omega &= \int_\Omega \nu \grad \uvec \cdot \grad \vvec \, d\Omega - \int_\boundary \nu \partialderivative{\uvec}{\normal} \cdot \vvec \, d\Omega \\
    \int_\Omega \grad p \cdot \vvec \, d\Omega &= - \int_\Omega p \div \vvec \, d\Omega + \int_\boundary p \vvec \cdot \normal \, d\gamma
\end{align*}
Using these relations in the first of \eqref{navier_stokes_ns} we obtain 
\begin{equation}
    \begin{split}
        \int_\Omega \partialderivative{\uvec}{t} \cdot \vvec \, d\Omega + \int_\Omega \nu \grad \uvec \cdot\grad \vvec \, d\Omega  + \int_\Omega \left[ \left( \uvec \cdot \grad \right) \uvec \right] \cdot \vvec \, d\Omega \\
        - \int_\Omega p\div \vvec \, d\Omega = \int_\Omega \vect{f} \cdot \vvec \, d\Omega + \int_\boundary \left( \nu \partialderivative{\uvec}{\normal} - p\normal \right) \cdot \vvec \, d\gamma \quad \forall \; \vvec \in V
    \end{split}
    \label{first_weak_formulation_ns}
\end{equation}
Similarly, by multiplying the second equation of \eqref{navier_stokes_ns} by a test function \(q\), belonging to a suitable space \(Q\) to be specified, then integrating in \(\Omega\) it follows that 
\begin{equation}
    \int_\Omega q \div \uvec \, d\Omega = 0 \quad \forall \; q \in Q
    \label{weak_formulation_div_ns}
\end{equation}
Usually, \(V\) is chosen so that the test functions vanish on the boundary portion where a Dirichlet data is prescribed on \(\uvec\)
\begin{equation}
    V = \left[ H^1_{\Gamma_D} \right]^d = \left\{ \vvec \in [H^1(\Omega)]^d : \vvec\limited{\Gamma_D} = \vect{0}\right\}
    \label{space_galerkin_ns}
\end{equation}
It will coincide with \(\left[ H^1_0(\Omega) \right]^d\) if \(\Gamma_D = \boundary\). 

If \(\Gamma_N\) has positive measure, we can choose \(Q = L^2(\Omega)\). If \(\Gamma_D = \boundary\), then the pressure space should be \(L^2_0\) to ensure uniqueness for the pressure \(p\). 

Moreover, if \(t>0\), then \(\uvec(t) \in \left[ H^1(\Omega) \right]^d\), with \(\uvec(t) = \bm{\phi}(t)\) on \(\Gamma_D\), \(\uvec(0) = \uvec_0\) and \(p(t) \in Q\). 
Having chosen these functional spaces, we can note first of all that 
\[
    \int_\boundary \left( \nu\partialderivative{\uvec}{\normal} - p\normal \right) \cdot \vvec \, d\gamma = \int_{\Gamma_N} \bm{\psi} \cdot \vvec \, d\gamma \quad \forall \; \vvec \in V
\]
\begin{notation}
    For every function \(\vvec \in \vect{H}^1(\Omega)\), we denote by 
    \[
        \norm{\vvec}_{\vect{H}^1(\Omega)} = \left( \sum_{k=1}^{d}\honenorm{v_k}^2 \right)^{\onehalf}
    \]
    its norm, and by 
    \[
        \seminorm{\vvec}{\vect{H}^1(\Omega)} = \left( \sum_{k=1}^{d} \seminorm{v_k}{H^1{\Omega}}^2 \right)^\onehalf
    \]
    its seminorm. Thanks to Poincaré's inequality, \(\seminorm{\vvec}{\vect{H}^1(\Omega)}\) is equivalent to \(\norm{\vvec}_{\vect{H}^1(\Omega)}\) for all functions belonging to \(V\), provided that the Dirichlet boundary has a positive measure.
\end{notation}
All the integrals involving bilinear terms are finite. To be more precise, by using the vector notation \(\vect{H}^k(\Omega) = [H^k(\Omega)]^d, \vect{L}^p(\Omega) = [L^p(\Omega)]^d, k \geq 1, 1\leq p < \infty\), we find 
\begin{align*}
    \abs{\nu \int_\Omega \grad \uvec \cdot \grad \vvec \, d\Omega} &\leq \nu \seminorm{\uvec}{\vect{H}^1(\Omega)} \seminorm{\vvec}{\vect{H}^1(\Omega)} \\
    \abs{\int_\Omega p\div \vvec \, d\Omega} &\leq \ltwonorm{p} \seminorm{\vvec}{\vect{H}^1(\Omega)} \\
    \abs{\int_\Omega q\grad \uvec \, d\Omega} &\leq \ltwonorm{q} \seminorm{\uvec}{\vect{H}^1(\Omega)}
\end{align*}
Also the integral involving the trilinear term is finite. Before we see how let's recall the following result: if \(d \leq 3\)
\[
    \forall \; \vvec \in \vect{H}^1(\Omega), \txt{ then } \vvec \in \vect{L}^4(\Omega) \txt{ and } \exists \; C > 0 : \norm{\vvec}_{\vect{L}^4(\Omega)} \leq C \norm{\vvec}_{\vect{H}^1(\Omega)}.
\]
Then, using the following three-term Hölder inequality 
\[
    \abs{\int_\Omega fgh \, d\Omega} \leq \norm{f}_{L^p(\Omega)} \norm{g}_{L^q(\Omega)} \norm{h}_{L^r(\Omega)},
\]
valid for all \(p, q, r > 1\) such that \(p^{-1} + q^{-1} + r^{-1} = 1\), we conclude that 
\[
    \abs{\int_\Omega \left[ \left( \uvec \cdot \grad \right) \uvec \right] \cdot \vvec \, d\Omega} \leq \norm{\grad \uvec}_{\vect{L}^2(\Omega)} \norm{\uvec}_{\vect{L}^4(\Omega)} \norm{\uvec}_{\vect{L}^4(\Omega)} \leq C^2 \norm{\vect{u}}_{\vect{H}^1(\Omega)}\norm{\vvec}_{\vect{H}^1(\Omega)}.
\]
\subsection{Solution uniqueness}
As for the solution's uniqueness, let us consider again \eqref{navier_stokes_ns}. If \(\Gamma_D = \boundary\), when only boundary conditions of Dirichlet type are imposed, the pressure merely appears in terms of its gradient. In that case if we call \((\uvec, p)\) a solution, then for any constant \(c\) the couple \((\uvec, p+c)\) is a solution too since \(\grad (p+c) = \grad p\).

To avoid that, one can fix a priori \(p\) at a given point \(\xvec_0\) of the domain \(\Omega\) such that \(p(\xvec_0) = p_0\), or, alternatively, require the pressure average to be null, \(\int_\Omega p\,d\Omega \). 
This condition requires to prescribe a pointwise value for the pressure, but this is inconsistent with the hypotesis that \(p \in L^2 \). For this reason, the pressure space will be considered as 
\[
    Q = L^2_0(\Omega) = \left\{ p \in L^2(\Omega) : \int_\Omega p \, d\Omega = 0 \right\}.
\]
Then, we observe that if \(\Gamma_D = \boundary\), the prescribed Dirichlet data \(\bm{\phi}\) must be compatible with the incompressiblility constant 
\[
    \int_\Omega \bm{\phi} \cdot \normal \, d\gamma = \int_\Omega \div \uvec \, d\Omega = 0.
\]
If \(\Gamma_N\) is not empty, we are ok with using \(L^2(\Omega)\) for our pressure space.
So: 
\begin{equation}
    Q =  L^2(\Omega) \quad \txt{ if } \Gamma_N \neq \emptyset, \quad Q = L^2_0(\Omega) \quad \txt{ if } \Gamma_N = \emptyset
    \label{8_slide_ns}
\end{equation}
The weak formulation of \eqref{navier_stokes_ns}, \eqref{initial_condition_ns}, \eqref{boundaries_ns} is:
\begin{equation}
    \begin{split}
        \find\uvec \in L^2(\real^+; \left[ H^1(\Omega) \right]^d) \cap \mathcal{C}^0(\real^+;\left[ L^2(\Omega) \right]^d), p \in L^2(\real^+; Q) : \\
        \begin{cases}
            \begin{split}
                \displaystyle \int_\Omega \partialderivative{\uvec}{t} \cdot \vvec \, d\Omega + \nu \int_\Omega \grad \uvec \cdot \grad \vvec \, d\Omega + \int_\Omega \left[ \left( \uvec \cdot \grad \right) \uvec \right] \cdot \vvec \, d\Omega \\
                -\int_\Omega p\div \vvec \, d\Omega = \int_\Omega \vect{f} \cdot \vvec \, d\Omega + \int_{\Gamma_N} \bm{\psi} \cdot \vvec \, d\gamma \quad \forall \; \vvec \in V
            \end{split} \\
            \displaystyle \int_\Omega q \div \uvec \, d\Omega = 0 \quad \forall \; q \in Q
        \end{cases}
    \end{split}
    \label{9_slide_ns}
\end{equation}
with \(\uvec\limited{\Gamma_D} = \bm{\psi}_D\) and \(\uvec\limited{t=0} = \uvec_0\). The space \(V\) is the one in \eqref{space_galerkin_ns}, while \(Q\) the one in \eqref{8_slide_ns}.
\subsection{The Reynolds number}
Let us define the Reynolds number, 
\begin{equation*}
    Re = \frac{\abs{\vect{U}}L}{\nu}
\end{equation*}
where \(\vect{U}\) is a representative length of the domain \(\Omega\) (e.g. the length of the channel in which the fluid flows), \(\vect{U}\) a representative fluid velocity and \(\nu\) the kinematic viscosity. 

This number measures the extent to which convection dominates over diffusion. When \(Re \ll 1\), the convective term \((\uvec \cdot \grad)\uvec\) can be omitted, reducing the equations to the so-called Stokes equation. On the other hand, for large values of \(Re\) problems may arise, concerning the uniqueness of the solution, the existence of stationary and stable solutions, the possibility of strange attractors and the transition towards turbulent flows.
\subsection{Divergence free formulation of Navier-Stokes equations}
By eliminating the pressure, the Navier-Stokes equations can be rewritten in a reduced form, with the sole variable \(\uvec\). Introducing the following subspaces of \(\left[ H^1(\Omega) \right]^d\):
\begin{align*}
    &V_{div} = \left\{ \vvec \in \honed : \div \vvec = 0 \right\} \\
    &V_{div}^0 = \left\{ \vvec \in V_{div} : \vvec = \vect{0} \txt{ on }\Gamma_D \right\}
\end{align*}
If the test function \(\vvec\) belongs to the space \(V_{div}\), the term associated with the pressure gradient vanishes, whence we find the following reduced problem for the velocity
\begin{equation}
    \begin{split}
    \find\uvec \in L^2(\real^+; V_{div}) \cap \mathcal{C}^0(\real^+;\left[ L^2(\Omega) \right]^d): \\
        \int_\Omega \partialderivative{\uvec}{t} \cdot \vvec \, d\Omega + \nu \int_\Omega \grad \uvec \cdot \grad \vvec \, d\Omega + \int_\Omega \left[ \left( \uvec \cdot \grad \right)\uvec \right] \cdot \vvec \, d\Omega \\
        = \int_\Omega \vect{f} \cdot \vvec \, d\Omega + \int_{\Gamma_N} \bm{\psi} \cdot \vvec \, d\gamma \quad \forall \; \vvec \in V_{div},
    \end{split}
    \label{10_slide_ns}
\end{equation}
with \(\uvec\limited{\Gamma_D} = \bm{\psi}_D\) and \(\uvec\limited{t=0} = \uvec_0\).

Since we are dealing with a nonlinear parabolic problem, we can carry an analysis by using techniques similar to those applied in parabolic problems. Clearly a solution of \eqref{9_slide_ns} will be a suitable solution of \eqref{10_slide_ns}, while, for the converse, we have the following theorem 
\begin{theorem}
    Let \(\Omega \subset \real^d\) be a domain with Lipschitz-continuous boundary \(\boundary\). Let \(\uvec\) be a solution of the reduced problem \eqref{10_slide_ns}. Then exists a unique function \(p \in L^2(\real^+;Q)\) such that \((\uvec, p)\) is a solution of the full problem \eqref{9_slide_ns}
\end{theorem}
In practice, however, the results of this theorem, are quite unsuitable from a numerical viewpoint, since it requires the construction of the \(V_{div}\) subspaces, of the divergence-free velocity functions, etc... 

Moreover, the result of the above theorem is not constructive, as it does not provide a way to build the solution pressure \(p\).
\subsection{Stokes equations and their approximation}
In this section we will consider the generalized Stokes problem with homogeneous Dirichlet BC 
\begin{equation}
    \begin{cases}
        \sigma \uvec - \nu \Delta \uvec + \grad p = \vect{f} & \txt{in } \Omega \\
        \div \uvec = 0 & \txt{in } \Omega \\
        \uvec = \vect{0} & \txt{on }\boundary
    \end{cases}
        \label{11_slide_ns}
\end{equation}
for \(\sigma \geq 0\). 
This is the motion of an incompressible viscous flow in which the convective term has been neglected, since \(Re \ll 1\).
Moreover, one can generate a problem \eqref{11_slide_ns} also while using an implicit temporal discretization of the Navier-Stokes equations and by neglecting the convective term. 

We have indeed the following scheme, where \(k\) denotes the temporal index 
\begin{equation*}
    \begin{cases}
        \frac{\uvec^k - \uvec^{k-1}}{\tstep} - \nu \Delta \uvec^k + \grad p^k = \vect{f}(t^k) & \xvec \in \Omega, \ t > 0 \\
        \div \uvec^k = 0 & \xvec \in \Omega, \ t > 0 \\
        + B.C.
    \end{cases}
\end{equation*}
Hence, at each time step \(t^k\) we need to solve the following Stokes-like system of equations 
\begin{equation}
    \begin{cases}
        \sigma \uvec^k - \nu \Delta \uvec^k + \grad p^k = \bm{\tilde{\vect{f}}}^{\,k} & \txt{in } \Omega \\
        \div \uvec^k = 0 & \txt{in }\Omega \\
        + B.C.
    \end{cases}
    \label{12_slide_ns}
\end{equation}
where \(\sigma = (\tstep)^{-1}\) and \(\bm{\tilde{\vect{f}}}^{\,k} = \bm{\tilde{\vect{f}}}(t^k) + \frac{\uvec^{k-1}}{\tstep}\).
The weak formulation of problem \eqref{11_slide_ns} reads: 
\begin{equation}
    \find \uvec \in V \txt{ and } p \in Q : 
    \begin{cases}
        \displaystyle \int_\Omega \left( \sigma \uvec \cdot \vvec + \nu \grad u \cdot \grad v \right) \, d\Omega - \int_\Omega p \div \vvec \, d\Omega = \int_\Omega \vect{f} \cdot \vect{v} \, d\Omega & \forall \; \vvec \in V, \\
        \displaystyle \int_\Omega q \div \uvec \, d\Omega = 0 & \forall \; q \in Q,
    \end{cases}
    \label{13_slide_ns}
\end{equation} 
where \(V = \left[ H^1_0(\Omega) \right]^d\) and \(Q = L^2_0(\Omega)\). Now with the bilinear forms \(a : V \times V \to \real\) and \(b:V\times Q \to \real\):
\begin{equation}
    \begin{aligned}
        &a(\uvec, \vvec) = \int_\Omega \left( \sigma \uvec \cdot \vvec + \nu \grad \uvec \cdot \grad \vvec \right) \, d\Omega, \\
        &b(\uvec, q) = -\int_\Omega q\div\uvec \, d\Omega.
    \end{aligned}
    \label{14_slide_ns}
\end{equation}
Using these notations, problem \eqref{13_slide_ns} becomes
\begin{equation}
    \find(\uvec,p) \in V \times Q:
    \begin{cases}
        a(\uvec,\vvec) + b(\vvec, p) =  (\vect{f}, \vvec) & \forall \; \vvec \in V \\
        b(\uvec, q) = 0 &\forall \; q \in Q
    \end{cases}
    \label{15_slide_ns}
\end{equation}
where \((\vect{f}, v) = \sum_{i=1}^{d} \int_\Omega f_iv_i \, d\Omega\).

Considering non-homogeneous BC like in \eqref{boundaries_ns}, the weak formulation of the Stokes problem becomes
\begin{equation}
    \find (\overset{\mathrm{o}}{\uvec}, p) \in V \times Q: 
    \begin{cases}
        a(\overset{\mathrm{o}}{\uvec}, \vvec) + b(\vvec, p) = \vect{F}(\vvec) & \forall \; \vvec in V \\
        b(\overset{\mathrm{o}}{\uvec}, q) = G(q) &\forall \; q \in Q
    \end{cases}
    \label{16_slide_ns}
\end{equation}
where \(V\) and \(Q\) are the spaces \eqref{space_galerkin_ns} and \eqref{8_slide_ns}, respectively. Having denoted with \(\vect{R}\bm{\phi} \in \honed\) a lifting of the boundary datum \(\bm{\phi}\), we have set \(\overset{\mathrm{o}}{\uvec} = \uvec -\vect{R}\bm{\phi}\), while the new terms on the right-hand side have the following expression
\begin{equation}
    \begin{aligned}
        \vect{F}(\vvec) &= (\vect{f}, \vvec) + \int_{\Gamma_N} \bm{\psi}\vvec \, d\gamma - a(\vect{R}\bm{\phi}, \vvec), \\
        G(q) &= -b(\vect{R}\bm{\phi}, q)
    \end{aligned}
    \label{17_slide_ns}
\end{equation}
\begin{theorem}
    The couple \((\uvec, p)\) solves the problem \eqref{15_slide_ns} if and only if it is a saddle point of the Lagrangian functional 
    \[
        \mathcal{L}(\vvec, q) = \onehalf a(\vvec,\vvec) + b(\vvec,q) - (\vect{f}, \vvec)    
    \]
    or equivalently 
    \[
        \loperator(\uvec, p) = \min_{\vvec \in V} \max_{q \in Q} \loperator (\vvec, q)    
    \]
\end{theorem}
The pressure \(q\) hence plays the role of Lagrange multiplier associated to the divergence-free constraint. 
We need to define the Fréchet derivative. 
\begin{definition}[Fréchet derivative]
    Let \(F:X\to Y\) with \(X,Y\) two normed vector spaces. \(F\) is differentiable at \(x \in X\) if \(\exists \; \loperator_x: X\to Y\) linear and bounded such that 
    \[
        \forall \; \epsilon > 0 \ \exists \; \delta > 0 \ \norm{F(x+h) - F(x) - \loperator_x h}_Y \leq \epsilon\norm{h}_X \quad \forall \; h \in X : \norm{h}_X < \delta
    \]
    \(F'(x) := \loperator_x\) is called Fréchet derivative of \(F\) at point \(x\).
\end{definition}
By formally taking the Fréchet derivative of the Lagrangian with respect to the two variables (thanks to the symmetry of \(\bilinear\)): 
\begin{align*}
    &\bigg\langle\partialderivative{\loperator(\uvec, p)}{\uvec}, \vvec \bigg\rangle = a(\uvec, \vvec) +b(\vvec,p) -(\vect{f},\vvec) = 0 \quad \forall \; \vvec \in V \\
    &\bigg\langle \partialderivative{\loperator(\uvec,p)}{p}, q\bigg\rangle = b(\uvec, q) = 0 \quad \forall \; q \in Q 
\end{align*}
\subsection{Galerkin approximation}
The Galerkin approximation of problem \eqref{15_slide_ns} has the following form: 
\begin{equation}
    \find(\uvec_h, p_h) \in V_h\times Q_h :
    \begin{cases}
        a(\uvec_h,\vvec_h) + b(\vvec_h, p_h) =(\vect{f}, \vvec_h) & \forall \; \vvec_h \in V_h \\
        b(\uvec, q_h) = 0 & \forall \; q_h \in Q_h
    \end{cases}
    \label{18_slide_ns}
\end{equation}
If, instead we consider problem \eqref{16_slide_ns}-\eqref{17_slide_ns}, we need to add \(\vect{F}(\vvec_h)\) and \(G(q_h)\). These new functionals can be obtained from \eqref{17_slide_ns} by replacing \(\vect{R}\bm{\phi}\) with the interpolant of \(\bm{\phi}\) at the nodes of \(\Gamma_D\), and replacing \(\bm{\phi}\) with its interpolant at the nodes on \(\Gamma_N\).

The existence and uniqueness is guaranteed by the theorem
\begin{theorem}
    The Galerkin approximation \eqref{18_slide_ns} admits one and only one solution if the following conditions hold
    \begin{itemize}
        \item The bilinear form \(\bilinear\) is:
        \begin{enumerate}
            \item coercive, that is \(\exists \; \alpha > 0\) (possibly depending on \(h\)) such that:
            \[
                a(\vvec_h, \vvec_h) \geq \alpha \norm{\vvec_h}^2_V \quad \forall\; \vvec_h \in V_h^*,
            \]
            where \(V_h^* = \left\{ \vvec_h \in V : b(\vvec_h,q_h) = 0 \quad \forall \; q_h \in Q_h \right\}\)
            \item continuous, that is \(\exists \; \gamma > 0\) such that 
            \[
                \abs{a(\uvec_h,\vvec_h)} \leq \gamma \norm{\uvec_h}_V \norm{\vvec_h}_V \quad \forall \; \uvec_h,\vvec_h \in V_h     
            \]
        \end{enumerate}
        \item The bilinear form \(b(\cdot, \cdot)\) is continuous, that is \(\exists \; \delta > 0\) such that 
        \[
            \abs{b(\vvec_h, q_h)} \leq \delta \norm{\vvec_h}_V\norm{q_h}_Q \quad \forall \vvec_h \in V_h, q_h \in Q_h
        \]
        \item Finally, there exist a positive constant \(\beta\) (possibly depending on \(h\)) such that:
        \begin{equation}
            \forall \; q_h \in Q_h, \ \exists \; \vvec_h \in V_h : b(\vvec_h, q_h) \geq \beta \norm{\vvec_h}_{\vect{H}^1(\Omega)}\ltwonorm{q_h}
            \label{19_slide_ns}
        \end{equation}
        Under the previous assumptions the discrete solution fullfills the following a priori estimates: 
        \begin{align*}
            \norm{\uvec_h}_V &\leq \frac{1}{\alpha} \norm{\vect{f}}_{V'} \\
            \norm{p_h}_Q &\leq \frac{1}{\beta} \left( 1+\frac{\gamma}{\alpha} \right) \norm{\vect{f}}_{V'},
        \end{align*}
        where \(V'\) is the dual space of \(V\).

        Moreover, the following convergence results hold:
        \begin{align*}
            \norm{\uvec - \uvec_h}_V &\leq \left( 1 +\frac{\delta}{\beta} \right) \left( 1 + \frac{\gamma}{\alpha} \right) \inf_{\vvec_h \in V_h} \norm{\uvec - \vvec_h}_V \\
            &\quad + \frac{\delta}{\alpha} \inf_{q_h \in Q_h} \norm{p - q_h}_Q, \\
            \norm{p-p_h}_Q &\leq \frac{\gamma}{\beta} \left( 1+\frac{\gamma}{\alpha} \right)\left(1 +\frac{\delta}{\beta} \right) \inf_{\vvec_h \in V_h} \norm{\uvec -\vvec_h}_V \\
            &\quad + \left( 1 + \frac{\delta}{\beta} + \frac{\delta \gamma}{\alpha \beta} \right) \inf_{q_h \in Q_h} \norm{p-q_h}_Q
        \end{align*}
    \end{itemize}
\end{theorem}
It is worth noticing that condition \eqref{19_slide_ns} is equivalent to the existence of a positive constant \(\beta\) such that
\begin{equation}
    \inf_{\substack{q_h \in Q_h \\ q_h \neq 0}} \sup_{\substack{\vvec_h \in V_h \\ \vvec_h \neq 0}} \frac{b(\vvec_h, q_h)}{\norm{\vvec_h}_{\vect{H}^1(\Omega)}\ltwonorm{q_h}} \geq \beta
    \label{20_slide_ns}
\end{equation}
Which is often called inf-sup condition. 
\subsection{A general saddle-point problem}
Let \(X\) and \(M\) be two Hilbert spaces endowed with norms \(\normdot_X\) and \(\normdot_M\). Denoting their dual spaces as \(X', M'\), we introduce the bilinear forms 
\begin{itemize}
    \item \(\bilinear : X\times X \to \real\) 
    \item \(b(\cdot, \cdot): M\times M \to \real\)
\end{itemize}
that we suppose to be continuous, meaning there exist two constants \(\gamma,\delta > 0\) such that for all \(w, v \in X\) and \(\mu \in M\)
\begin{equation}
    \begin{aligned}
        \abs{a(w,v)} \leq \gamma \norm{w}_X \norm{v}_X, \\
        \abs{b(w,\mu)} \leq \norm{w}_X \norm{\mu}_M
    \end{aligned}
    \label{21_slide_ns}
\end{equation}
Consider now the following constrained problem 
\begin{equation}
    \find (u,\eta) \in X \times M:
    \begin{cases}
        a(u,v) + b(v, \eta) = \langle I, v \rangle & \forall \; v \in X, \\
        b(u,\mu) = \langle \sigma, \mu\rangle & \forall \; \mu \in M
    \end{cases}
    \label{22_slide_ns}
\end{equation}
where \(I \in X'\) and \(\sigma \in M'\) are two assigned linear functionals, while \(\langle \cdot, \cdot \rangle\) denotes the pairing between \(X\) and \(X'\) or \(M\) and \(M'\).

Formulation \eqref{22_slide_ns} is general enough to include formulation \eqref{15_slide_ns} of the Stokes problem. In order to analyze \eqref{22_slide_ns}, we introduce the affine manifold 
\begin{equation}
    X^\sigma = \left\{ v \in X : b(v, \mu) = \scalarproduct{\sigma}{\mu} \ \forall \; \mu \in M\right\}
    \label{23_slide_ns}
\end{equation}
The space \(X^0\) denotes the kernel of \(b\), that is 
\[
    X^0 = \left\{ v \in X : b(v,\mu) = 0 \ \forall \; \mu \in M \right\}
\]
This is a closed subspace of \(X\). We can, therefore, associate \eqref{22_slide_ns} with the following reduced problem:
\begin{equation}
    \find u \in X^\sigma : a(u,v) =\scalarproduct{I}{v} \quad \forall \; v \in X^0
    \label{24_slide_ns}
\end{equation}
If \((u,\eta)\) is a solution of \eqref{22_slide_ns}, then it is a solution to \eqref{24_slide_ns}. In the following, we will introduce suitable condititions that allow the converse to hold too. Also, if we are able to prove existence and uniqueness for \eqref{24_slide_ns}, then this would allow us to obtain a result for \eqref{22_slide_ns}. 
\begin{theorem}[Existence, uniqueness and stability]
    Let the bilinear form \(\bilinear\) satisfy the continuity condition \eqref{21_slide_ns} and be coercive on \(X^0\), so 
    \begin{equation}
        \exists \; \alpha > 0 : a(v,v) \geq \alpha \norm{v}_X^2 \quad \forall \; v \in X^0
        \label{25_slide_ns}
    \end{equation}
    Suppose also that the bilinear form \(b(\cdot,\cdot)\) satisfies the same continuity condition as well as the following: there exists \(\beta^* > 0\) such that 
    \begin{equation}
        \forall \; \mu \in M \exists \; v \in X, \ v\neq 0 : b(v,\mu) \geq \beta^*\norm{v}_X\norm{\mu}_M.
        \label{26_slide_ns}
    \end{equation}
    Then, for every \(I \in X'\) and \(\sigma \in M'\), there exists a unique solution \((u,\eta)\in X \times M\) to the saddle point problem \eqref{22_slide_ns}.

    Moreover, the map \((I, \sigma) \mapsto (u, \eta)\) is an isomorphism from \(X' \times M'\) onto \(X \times M\) and the following a priori estimates hold 
    \begin{equation}
        \begin{aligned}
            \norm{u}_X &\leq \frac{1}{\alpha} \left[ \norm{I}_{X'} + \frac{\alpha + \gamma}{\beta^*} \norm{\sigma}_{M'} \right], \\
            \norm{\eta}_M &\leq \frac{1}{\beta} \left[ \left( 1+\frac{\gamma}{\alpha} \norm{I}_{X'}+ \frac{\gamma(\alpha+\gamma)}{\alpha \beta^*} \norm{\sigma}_{M'} \right) \right].
            \label{27_slide_ns}
        \end{aligned}
    \end{equation}
    \label{uniqueness_continuous}
\end{theorem}
\subsubsection*{Galerkin approximation}
To introduce a Galerkin approximation of the saddle-point problem \eqref{22_slide_ns}, we consider two subspaces \(X_h \subset X\) and \(M_h \subset M\), respectively. They can be either finite element piecewise polynomial subspaces or spectral element subspaces.
We look for a solution for the problem 
\begin{equation}
    \txt{given } I \in X' \txt{ and } \sigma \in M' \ \find (u_h, \eta_h) \in X_h \times M_h :
    \begin{cases}
        a(u_h, v_h) + b(v_h, \eta_h) = \scalarproduct{I}{v_h} & \forall \; v_h \in X_h \\
        b(u_h, \mu_h) = \scalarproduct{\sigma}{\mu_h} & \forall \; \mu_h \in M_h
    \end{cases}
    \label{28_slide_ns}
\end{equation}
We introduce the subspace 
\begin{equation}
    X^\sigma_h =\left\{ v_h \in X_h : b(v_h, \mu_h) = \scalarproduct{\sigma}{\mu_h} \ \forall \; \mu_h \in M_h \right\}
    \label{29_slide_ns}
\end{equation}
which allow us to introduce the following reduced formulation 
\begin{equation}
    \find u_h \in X_h^\sigma : a(u_h, v_h) = \scalarproduct{I}{v_h} \quad \forall \; v_h \in X_h^0
    \label{30_slide_ns}
\end{equation}
Since, in general, \(M_h\) is different from \(M\), the space \eqref{29_slide_ns} is not necessarily a subspace of \(X^\sigma\). 

Clearly, every solution of \((u_h, \eta_h)\) of \eqref{28_slide_ns} yields a solution \(u_h\) for the reduced problem \eqref{30_slide_ns}. Now we look for a solution that allows us to prove that the converse is true.
\begin{theorem}[Existence, uniqueness and stability]
    Let the bilinear form \(\bilinear\) satisfy the continuity condition \eqref{21_slide_ns} and be coercive on \(X^0\), so 
    \begin{equation}
        \exists \; \alpha > 0 : a(v_h,v_h) \geq \alpha_h \norm{v_h}_X^2 \quad \forall \; v_h \in X^0_h
        \label{31_slide_ns}
    \end{equation}
    Suppose also that the bilinear form \(b(\cdot,\cdot)\) satisfies the same continuity condition as well as the following: there exists \(\beta_h^* > 0\) such that 
    \begin{equation}
        \forall \; \mu_h \in M_h \exists \; v_h \in X_h, \ v_h\neq 0 : b(v_h,\mu_h) \geq \beta_h^*\norm{v_h}_X\norm{\mu_h}_M.
        \label{32_slide_ns}
    \end{equation}
    Then, for every \(I \in X'\) and \(\sigma \in M'\), there exists a unique solution \((u_h,\eta_h)\in X_h \times M_h\) to the saddle point problem \eqref{28_slide_ns}.

    Moreover, the solution satisfies the following conditions:
    \begin{align}
        \norm{u_h}_X &\leq \frac{1}{\alpha_h} \left[ \norm{I}_{X'} + \frac{\alpha_h + \gamma}{\beta_h^*} \norm{\sigma}_{M'} \right], \label{33_slide_ns}\\
        \norm{\eta_h}_M &\leq \frac{1}{\beta_h} \left[ \left( 1+\frac{\gamma}{\alpha_h} \norm{I}_{X'}+ \frac{\gamma(\alpha_h+\gamma)}{\alpha_h \beta_h} \norm{\sigma}_{M'} \right) \right]. \label{34_slide_ns}
    \end{align}
    \label{uniqueness_discrete}
\end{theorem}
The coercivity condition \eqref{25_slide_ns} does not necessarily guarantee \eqref{31_slide_ns}, as \(X_h^0 \not\subset X^0\), nor does the compatibility condition \eqref{26_slide_ns} in general imply the discrete compatibility condition \eqref{32_slide_ns} due to the fact that \(X_h\) is a proper subspace of \(X\). \eqref{32_slide_ns} is called inf-sup condition.

\begin{theorem}
    Let the assumptions of existence and uniqueness theorems \eqref{uniqueness_continuous} and \eqref{uniqueness_discrete} be satisfied. Then, the solutions \((u,\eta)\) and \((u_h, \eta_h)\) of problems \eqref{22_slide_ns} and \eqref{28_slide_ns}, respectively, satisfy the following error estimates: 
    \begin{align}
        \norm{u-u_h}_X &\leq \left( 1+\frac{\gamma}{\alpha_h} \right)\int_{v_h^* \in X_h^\sigma} \norm{u-v_h}_X + \frac{\delta}{\alpha_h} \inf_{\mu_h \in M_h} \norm{\eta - \mu_h}_M \label{35_slide_ns} \\
            \norm{\eta - \eta_h}_M &\leq \frac{\gamma}{\beta_h} \left( 1+\frac{\gamma}{\alpha_h} \right) \inf_{v^*_h \in X_h^\sigma} \norm{u - v^*_h}_X + \left( 1 + \frac{\delta}{\beta_h} + \frac{\gamma \beta}{\alpha_h \beta_h} \right) \inf_{\mu_h \in M_h} \norm{\eta - \mu_h}_M \label{36_slide_ns}
    \end{align}
    where \(\gamma, \delta, \alpha_h\) and \(\beta_h\) are respectively defined by \eqref{21_slide_ns}, \eqref{31_slide_ns} and \eqref{32_slide_ns}. Also, the following estimate holds
    \begin{equation}
        \inf_{v^*_h \in X_h^\sigma} \norm{u - v_h}_X \leq \left( 1 + \frac{\delta}{\beta_h} \right) \inf_{v_h \in X_h} \norm{u - v_h}_X 
        \label{37_slide_ns}
    \end{equation}
\end{theorem}
The inequalities \eqref{35_slide_ns} and \eqref{36_slide_ns} yield error estimates with optimal convergence rate, provided that the constants \(\alpha_h\) and \(\beta_h\) in \eqref{31_slide_ns} and \eqref{32_slide_ns} are bounded from below by two constants \(\alpha\) and \(\beta\) indepedent of \(h\). Let us also remark that \eqref{35_slide_ns} holds even if \eqref{26_slide_ns} and \eqref{32_slide_ns} are not satisfied. 
\begin{remark}[Spurious pressure modes]
    The compatibility condition \eqref{32_slide_ns} is essential to guarantee the uniqueness of the \(\eta_h\)-component of the solution. Indeed, if \eqref{32_slide_ns} does not hold, then
    \[
        \exists \; \mu_h^* \in M_h, \ \mu_h^* \neq 0 : b(v_h, \mu_h^*) = 0 \quad \forall M v_h \in X_h.
    \]
    Consequently, if \((u_h, \eta_h)\) is a solution to the problem \eqref{28_slide_ns}, then \((u_h, \eta_h + \tau \mu_h^*)\), for all \(\tau \in \real\), is a solution too.

    Any such function \(\mu^*_h\) is called spurious mode.
    \label{spurious_mode_ns}
\end{remark}
\subsection*{Algebraic form of Stokes problem}
Let us investigate the structure of the algebraic system associated to the Galerkin approximation \eqref{18_slide_ns} to the Stokes problem (or, more generally, to a discrete saddle-point problem like \eqref{28_slide_ns}). Denote with 
\[
    \left\{ \bm{\phi}_j \in V_h \right\}, \quad \left\{ \oldphi_k \in Q_h \right\},
\]
the basis functions of the spaces \(V_h\) and \(Q_h\), respectively. Let us expand the discrete solutions \(\uvec_h\) and \(p_h\) w.r.t. such bases 
\begin{equation}
    \begin{aligned}
        \uvec_h(\xvec) &= \sum_{j=1}^{N} u_j\bm{\phi}_j(\xvec), \\
        p_h(\xvec) &= \sum_{k=1}^{M} p_k\oldphi_k(\xvec),
        \label{46_slide_ns}
    \end{aligned}
\end{equation}
having set \(N = \dim V_h\) and \(M = \dim Q_h\).

By choosing as test functions in \eqref{18_slide_ns} the same basis functions we obtain the following block linear system 
\begin{equation}
    \begin{cases}
        A\vect{U} + B^T \vect{P} = \vect{F}, \\
        B\vect{U} = \vect{0}
    \end{cases}
    \label{47_slide_ns}
\end{equation}
where \(A \in \real^{N\times N}\) and \(B \in \real^{M \times N}\) are the matrices related respectively to the bilinear forms \(\bilinear\) and \(b(\cdot, \cdot)\), whose elements are given by 
\begin{align*}
    A &= [a_{ij}] = [a(\bm{\phi_j, \phi_i})], \\
    B &= [b_{km}] = [b(\bm{\phi_m}, \oldphi_k)],
\end{align*}
while \(\vect{U}\) and \(\vect{P}\) are the vectors of the unknowns, 
\begin{align*}
    \vect{U} &= [u_j], \\
    \vect{P} &= [p_j].
\end{align*}
The \((N+M) \times (N+M)\) matrix 
\begin{equation}
    S = \left[ \begin{matrix}
        A & B^T \\ B & 0
    \end{matrix} \right]
    \label{48_slide_ns}
\end{equation}
is block-symmetric (as \(A\) is symmetric) and indefinite, featuring real eigenvalues with variable sign. \(S\) is non-singular if and only if it is null, a property that follows from the inf-sup condition \eqref{20_slide_ns}.

To prove the latter statement we proceed as follows. 

Since \(A\) is non-singular, because it is associated to the coercive bilinear form \(\bilinear\), from the first of \eqref{47_slide_ns}, we can formally obtain \(\vect{U}\) as 
\begin{equation}
    \vect{U} = A^{-1}(\vect{F} - B^T\vect{P})
    \label{49_slide_ns}
\end{equation}
Using \eqref{49_slide_ns} in the second equation of \eqref{47_slide_ns} yields
\begin{equation}
    R\vect{P} = BA^{-1}\vect{F}, \txt{ where } R=BA^{-1}B^T 
    \label{50_slide_ns}
\end{equation}
This corresponds to having carried out a block Gaussian elimination on system \eqref{48_slide_ns}.
In this way we obtain a reduced system for the sole unknown \(\vect{P}\), which admits a unique solution in case \(R\) is non-singular and positive definite, we want to prove that the latter condition is satisfied if and only if \(B^T\) has a null kernel, that is 
\begin{equation}
    \ker (B^T) = \left\{ \vect{0} \right\}
    \label{51_slide_ns}
\end{equation}
where \(\ker (B^T) = \left\{ \xvec \in \real^M : B^T \xvec = \vect{0} \right\}\). 

We proceed as follows: 
\[
    R\vect{p} = \vect{0} \Rightarrow \vect{p} = \vect{0}
\]
that is 
\[
    \scalarproduct{BA^{-1}B^T\vect{p}}{\vect{q}} = \vect{0} \ \forall \; \vect{q} \Rightarrow \vect{p} = \vect{0}
\]
Let us take \(\vect{q} = \vect{p}\). We require:
\[
    \scalarproduct{A^{-1}B^T \vect{p}}{B^T\vect{q}} = \vect{0} \Rightarrow \vect{p} = \vect{0}
\]
Set \(\vect{w} = B^T \vect{p}\). Since \(A\) is spd, we have that \(\scalarproduct{A^{-1}\vect{w}}{\vect{w}} = \vect{0}\), which implies \(\vect{w} = \vect{0}\). Finally,
\[
    (\vect{w} = B^T \vect{p} = \vect{0} \Rightarrow \vect{p} = \vect{0}) \iff \ker (B^T) =  \left\{ \vect{0} \right\}
\]
\begin{remark}
    Condition \eqref{51_slide_ns} is equivalent to the inf-sup condition \eqref{20_slide_ns}.
\end{remark}
On the other hand, since \(A\) is non-singular, from the existence and uniqueness \(\vect{P}\) we infer that there exists a unique vector \(\vect{U}\) which satisfies \eqref{49_slide_ns}. 

In conclusion, system \eqref{47_slide_ns} admits a unique solution \((\vect{U}, \vect{P})\) if and only if condition \eqref{51_slide_ns}. 

\begin{remark}
    We remark that, for an arbitrary matrix, \(B^T (N\times M)\), we have \(\rank(B^T) + \dim \ker (B^T) = \min(M,N)\). 
    
    Then, condition \eqref{51_slide_ns} is equivalent to asking that \(B^T\) has a full rank, because \(\rank(B^T)\) is the maximum number of linearly indepedent row vectors of \(B^T\).
\end{remark}
Let us consider the remark \eqref{spurious_mode_ns}  concerning the general saddle-point problem and suppose that the inf-sup condition \eqref{20_slide_ns} does not hold. Then, 
\begin{equation}
    \exists \; q_h^* \in Q_h : b(\vvec_h, q^*_h) = 0 \quad \forall \; \vvec_h \in V_h.
    \label{52_slide_ns}
\end{equation}
Consequently, if \((\uvec_h, p_h)\) is a solution to the Stokes problem \eqref{18_slide_ns}, then \((\uvec_h, p_h+q_h)\) is a solution too:
\begin{equation*}
    \begin{aligned}
        a(\uvec_h, \vvec_h) + b(\vvec_h, p_h+q_h) &= a(\uvec,\vvec) + b(\vvec_h, p_h) + \underbrace{b(\vvec_h, q^*_h)}_{=0} \\ 
        &= a(\uvec_h, \vvec_h) + b(\vvec_h, p_h) = (\vect{f}, \vvec_h)
    \end{aligned}
    \quad \forall \; \vvec_h \in V_h
\end{equation*}
Functions \(q_h^*\) which fail to satisfy the inf-sup condition are invisible to the Galerkin problem \eqref{18_slide_ns}. For this reason, as already observed, they are called spurious pressure modes, or parasitic modes. Their presence yields numerical instabilities. 

Two strategies are generally adopted in order to guarantee well-posedness of the numerical problem:
\begin{itemize}
    \item choose spaces \(V_h\) and \(Q_h\) that satisfy the inf-sup condition. 
    \item Stabilize the finite dimensional problem by eliminating spurious modes.
\end{itemize}
\subsection{Suitable spaces}
Let us analyze the first type of strategy. To start with, we will consider the case of finite element spaces. To characterize \(Q_h\) and \(V_h\) it suffices to choose on every elemnt their degrees of freedom. Since the weak formulation does not require a continuous pressure, we will consider the case of a discontinuous pressure first. 

As Stokes equation are of order one in \(p\) and two in \(\uvec\) it makes sense to use polynomials of degree \(k \geq 1\) for \(V_h\) and of degree \(k-1\) for \(Q_h\).  When looking for a compatible couple of spaces, the larger the velocity space \(V_h\), the more likely the inf-sup condition is satisfied. 

Suitable choices of spaces that fullfill the inf sup pressure are, for example, the couple \((\mathbb{P}_2, \mathbb{P}_0)\), \((\mathbb{Q}_2, \mathbb{P}_0)\) or the so-called Crouzeix Raviart elements, in which the velocity components are piecewise quadratic functions with a bubble function on each element, while the pressure components are piecewise linear discontinuous element.

In the case of continuous pressure, examples of incompatible spaces could be piecewise linear elements on triangles for both velocity and pressure. More in general, not a good idea to use the same polynomial degree.

The smallest degree possible for stability is the pair \((\mathbb{P}_2, \mathbb{P}_1)\), which are called Tayor-Hood elements.
\subsubsection*{Spectral methods}
If we use spectral methods using equal-order polynomial spaces for both velocity and pressure yields subspaces that violate the inf-sup condition. Compatible spaces can be the ones with polynomial degree \(N \geq 2\) for the velocity and \(N-2\) for the pressure, yielding the so called \((\mathbb{Q}_N, \mathbb{Q}_{N-2})\) approximation. The degrees of freedom for each velocity components are represented by the \((N+1)^2\) LGL nodes.

In the case of discontinuous pressure, at least two sets of interpolation nodes can be used: either the subset represented by the \((N-1)^2\) internal nodes of the choice above, or the set \((N-1)^2\) LGL nodes. This choice stands at the base of the spectral-type approximation, such as collocation, G-NI or SEM-NI.
\subsection{A stabilized problem}
We have seen that finite element or spectral methods that make use of equal-degree polynomial do not fullfill the inf-sup condition and are therefore unstable. However, stabilizing them is possible by using SUPG or GLS techniques like those enconuntered in the approximation of ADR equation.

Here we will limit ourselves to the case of piecewise continuous linear finite elements (\(\mathbb{P}_1, \mathbb{P}_1\)), stabilized using GLS.
\[
    V_h = [\overset{\mathrm{o}}{X^1_h}]^2, \ \quad Q_h = \left\{ q_h \in X_h^1 : \int_\Omega \, d\Omega = 0 \right\}.
\]
This choice is urged by the need of keeping the global numer of degrees of freedom as low as possible, especially when dealing with three-dimensional problem. However, as it violates the inf-sup condition, it will be unstable.

So, we set \(W_h = V_h \times Q_h\), and, instead of \eqref{18_slide_ns}, we consider the problem 
\begin{equation}
    \find (\uvec_h, p_h) \in W_h : A_h ((\uvec_h, p_h), (\vvec_h, q_h)) = F_h (\vvec_h, q_h) \quad \forall \; (\vvec_h, q_h) \in W_h 
    \label{53_slide_ns}
\end{equation}
We have set 

\begin{align*}
    &A_h : W_h \times W_h \to \real, \\
    &A_h((\uvec_h, p_h), (\vvec_h, q_h)) = a(\uvec_h, \vvec_h) + b(\vvec_h, p_h) - b(\uvec_h, q_h) \\
    &\qquad + \delta \sum_{\eit} h_\element^2 \int_\element \left( -\nu\Delta \uvec_h + \grad p_h \right)\left( -\nu \Delta \vvec_h + \grad q_h \right) \, d\element, \\
    &F_h : W_h \to \real, \\
    &F_h(\vvec_h, q_h) = (\vect{f},\vvec_h) + \delta \sum_\eit h^2_\element \int_\element \vect{f}(-\nu\Delta \vvec_h + \grad q_h) \, d\element
\end{align*}
and \(\delta\) is a positive parameter chosen accordingly.

This is a strongly consistent approximation of problem \eqref{11_slide_ns}. As a matter of fact, the additional term is null when calculated on the exact solution thanks to \eqref{13_slide_ns}. Note that, since \(k=1, \Delta {\uvec_h}\limited{\element} = \Delta {\vvec_h}\limited{\element} = \vect{0} \; \forall \; \eit\) as we are using piecewise linear finite elements functions.

We obtain the following stability inequality 
\begin{equation}
    \nu \norm{\grad\uvec_h}_{\vect{L}^2(\Omega)}^2 + \delta \sum_\eit h^2_\element \norm{\grad p_h}^2_{\vect{L}^2 (\element)} \leq C \norm{\vect{f}}^2_{\vect{L}^2(\Omega)},
    \label{55_slide_ns}
\end{equation}
\(C\) being a constant that depends on \(\nu\) but not on \(h\). 

By applying Strang's Lemma \eqref{strang_lemma_sem} we can now show that the solution to the generalized Galerkin problem \eqref{53_slide_ns} satisfies the following estimate 
\[
    \norm{\vect{u} - \vect{u}_h}_{\vect{H}^1(\Omega)} + \left( \delta \sum_\eit h^2_\element \norm{\grad p - \grad p_h}_{\vect{L}^2(\element)}^2 \right)^\onehalf \leq Ch.
\]
We can show that \eqref{53_slide_ns} admits the following matrix form
\begin{equation}
    \left[ \begin{matrix}
        A & B^T \\
        B & -C
    \end{matrix} \right] \left[ \begin{matrix}
        \vect{U} \\ \vect{P}
    \end{matrix} \right] = \left[ \begin{matrix}
        \vect{F} \\ \vect{G}
    \end{matrix} \right].
    \label{56_slide_ns}
\end{equation}
This system differs from \eqref{47_slide_ns} without stabilization because of the presence of the non-null block occupying the position \((2,2)\) which is associated to the stabilization term:
\[
    C = [c_{km}], \;  c_{km} = \delta \sum_\eit h^2_\element \int_\element \grad \oldphi_m \cdot \grad \oldphi_k \, d\element, k,m = 1,\ldots, M
\]
while the components of the right-hand side \(\vect{G}\) are 
\[
    g_k = -\delta \sum_\eit h^2_\element \int_\element \vect{f} \cdot \grad \oldphi_k \, d\element, k = 1,\ldots, M
\]
Note that
\begin{align*}
    A\vect{U} + B^T\vect{P} = \vect{F} &\Rightarrow \vect{U} = A^{-1} (\vect{F} - B^T\vect{P}),\\
    B\vect{U} - C\vect{P} & \Rightarrow BA^{-1} \vect{F} - BA^{-1}B^T \vect{P} -C\vect{P} = \vect{G} \\
    &\Rightarrow (BA^{-1}B^T + C)\vect{P} = BA^{-1} \vect{F} - \vect{G}.
\end{align*}
Then, in this case, the reduced system reads 
\[
    R\vect{P} = BA^{-1} \vect{F} - \vect{G}.
\]
In contrast to \eqref{50_slide_ns}, this time the matrix \(R\) is non-singular as \(C\) is positive defined, but \(B^T\) is not full-rank.
\subsection{Time discretization}
We consider the following semi discretized formulation
\begin{equation}
    \begin{cases}
        M\dfrac{d\uvec(t)}{dt} + A\uvec(t) + C(\uvec(t))\uvec(t) + B^T\vect{p}(t) = \vect{f}(t) ,\\
        B\uvec(t) = \vect{0},
        \label{58_slide_ns}
    \end{cases}
\end{equation}
with \(\uvec(0) = \uvec_0\). \(C(\uvec(t))\) is in fact a matrix depending on \(\uvec(t)\), whose generic coefficient is \(c_{ij}(t) = c(\uvec(t), \phi_j, \phi_i)\).

For the temporal discretization of this system let us use the \(\theta\)-method. By setting
\begin{align*}
    &\uvec_\theta^{n+1} = \theta \uvec^{n+1} + (1-\theta)\uvec^n, \\
    &\pvec_\theta^{n+1} = \theta \pvec^{n+1} + (1-\theta)\pvec^n, \\
    &\fvec_\theta^{n+1} = \theta \fvec^{n+1} + (1-\theta)\fvec^n, \\
    &C_\theta(\uvec^{n+1,n})\uvec^{n+1,n} = \theta C(\uvec^{n+1})\uvec^{n+1} + (1-\theta)C(\uvec^{n})\uvec^{n}
\end{align*}
we obtain 
\begin{equation}
    \begin{cases}
        M\dfrac{\uvec^{n+1}-\uvec^n}{\tstep} + A\uvec_\theta^{n+1} + C_\theta(\uvec^{n+1,n})\uvec^{n+1,n} + B^T\pvec_\theta^{n+1} = \fvec_\theta^{n+1} \\
        B\uvec^{n+1} = \vect{0}
    \end{cases}
    \label{59_slide_ns}
\end{equation}
Since, except for the forward Euler method, the solution of this system is quite involved, a possible alternative is a semi-implicit scheme in which the linear part of the equation is advanced implicitly, while the nonlinear ones explicitly. In this way, for \(\theta \geq \onehalf\), the resulting scheme is unconditionally stable, whereas, in all other cases, it must obey a stability restriction on the timestep \(\tstep\). 
\subsubsection*{Finite difference methods}
We consider an explicit temporal discretization of the first equation in \eqref{58_slide_ns}, corresponding to \(\theta = 0\) in \eqref{59_slide_ns}. If all the quantities are known at \(t^n\), then we can write
\begin{equation*}
    \begin{cases}
        M\uvec^{n+1} = H(\uvec^n, \pvec^n,\fvec^n) \\
        B\uvec^{n+1} =\vect{0}
    \end{cases}
\end{equation*}
with \(M\) mass matrix 
\[
    m_{ij} = \int_\Omega \bm{\phi}_i \bm{\phi}_j
\]
This system does not allow the determination of the pressure \(\pvec^{n+1}\). In particular, there is no way to enforce the divergence-free constraints on \(\uvec^{n+1}\). However, if we replace \(\pvec^n\) by \(\pvec^{n+1}\) we obtain 
\begin{equation}
    \begin{cases}
        \frac{1}{\tstep} M \uvec^{n+1} + B^T\pvec^{n+1} = \vect{G}, \\
        B\uvec^{n+1} = \vect{0} ,
    \end{cases}
    \label{60_slide_ns}
\end{equation}
with \(\vect{G}\) being a suitable vector. This system corresponds to a semi-explicit discretization of \eqref{58_slide_ns}. Since \(M\) is symmetric and positive definite, if condition \eqref{51_slide_ns} is satisfied, then the reduced system \(BM^{-1}B^T \pvec^{n+1} = BM^{-1}\vect{G}\) is non-singular. Once solved, the velocity vector \(\uvec^{n+1}\) can be recovered from the first equation of \eqref{60_slide_ns}. This discretization method is temporally stable if 
\[
    \tstep \leq C\min\left( \frac{h^2}{\nu}, \frac{h}{\max_{\xvec\in\Omega}\abs{\uvec^n(\xvec)}} \right).
\]

Let us now consider an implicit discretization of \eqref{58_slide_ns}, for instance the backward Euler method. As already seen, this is an unconditionally stable method. Its algebraic system can be regarded as the finite element space approximation of the Navier-Stokes problem 
\begin{equation*}
    \begin{cases}
        -\nu\Delta u^{n+1} + (\uvec^{n+1} \cdot \grad)\uvec^{n+1} + \grad p^{n+1} + \frac{\uvec^{n+1}}{\tstep} = \tilde{\fvec}, \\
        \div \uvec^{n+1} = 0.
    \end{cases}
\end{equation*}
The solution of such nonlinear algebraic system can be achieved by Newton-Krylov techniques, that is using a Krylov method to solve, at each timestep, a system obtained by a Newton method.
\subsubsection*{Fractional step methods}
Let us consider an abstract time dependent problem,
\[
    \partialderivative{w}{t} + \loperator w = f,
\]
where \(\loperator\) is a differential operator that splits into the sum of two operators \(\loperator_1\) and \(\loperator_2\) such that
\[
    \loperator v = \loperator_1 v + \loperator_2 v
\]
We perform an advancement in time only on the first operator, and then correct the solution by performing the advancement on the second operator. The idea is to separate a complex problem into smaller simpler ones, for example separating diffusion from transport.
\subsubsection*{Chorin Temam method}
This strategy also involves two operators: \(\loperator_1(\vect{w}) = -\nu\Delta \vect{w} + (\vect{w} \cdot \grad)\vect{w}\) whereas \(\loperator_2\) is associated to the remaining terms of \eqref{navier_stokes_ns}. Thanks to this solution we can split the main difficult of the Navier-Stokes equations, the nonlinear part from the incompressiblility constraint.

The corresponding scheme reads 
\begin{enumerate}
    \item Solve the diffusion-transport equation for the velocity \(\tilde{\uvec}^{n+1}\)
    \begin{equation}
        \begin{cases}
            \dfrac{\tilde{\uvec}^{n+1}-\uvec^n}{\tstep} -\nu\Delta \tilde{\uvec}^{n+1} + (\uvec^* \cdot \grad)\uvec^{**} = \fvec^{n+1} & \txt{in }\Omega, \\
            \tilde{\uvec}^{n+1} = \vect{0} & \txt{on }\boundary
        \end{cases}
        \label{63_slide_ns}
    \end{equation}
    \item solve the following problem for \(\uvec^{n+1}\) and \(p^{n+1}\)
    \begin{equation}
        \begin{cases}
            \dfrac{\tilde{\uvec}^{n+1}-\uvec^n}{\tstep} -\nu \Delta \tilde{\uvec}^{n+1} + (\uvec^* \cdot \grad)\uvec^{**} = \fvec^{n+1} & \txt{in }\Omega, \\
            \div \uvec^{n+1} = 0 & \txt{in } \Omega, \\
            \uvec^{n+1} \cdot \normal = 0 & \txt{on }\boundary,
        \end{cases}
        \label{64_slide_ns}
    \end{equation}
\end{enumerate}
where \(\uvec^*\) and \(\uvec^{**}\) can be either \(\tilde{\uvec}^{n+1}\) or \(\uvec^n\) depending on whether the nonlinear terms are treated.

In such a way, in the first step the velocity is calculated as \(\tilde{\uvec}^{n+1}\), and then it is corrected in the second step to satisfy the constraints.

While the first step is a classic advection-diffusion problem, the second step is a bit more tricky. First we need to apply the divergence operator to the first equation of \eqref{64_slide_ns}
\[
    \div\frac{\uvec^{n+1}}{\tstep} -\div \frac{\tilde{\uvec}^{n+1}}{\tstep} + \Delta p^{n+1} = 0,
\]
that is an elliptic boundary value problem with Neumann boundary conditions 
\begin{equation}
    \begin{cases}
        -\Delta p^{n+1} = -\div \dfrac{\tilde{\uvec}^{n+1}}{\tstep} & \txt{in }\Omega, \\
        \displaystyle\partialderivative{p^{n+1}}{n} = 0 & \txt{on }\boundary.
    \end{cases}
    \label{65_slide_ns}
\end{equation}
The Neumann condition follows from \(\uvec^{n+1}\cdot \normal = 0\) on \(\boundary\).

From the solution of \eqref{65_slide_ns} we obtain \(p^{n+1}\) and \(\uvec^{n+1}\) by using the first equation on \eqref{64_slide_ns}, 
\begin{equation}
    \uvec^{n+1} = \tilde{\uvec}^{n+1} - \Delta t \grad p^{n+1}
    \label{66_slide_ns}
\end{equation}
This is precisely the correction to operate on the velocity field in order to fullfill the divergence-free constraint. 

To conclude, the full algorithm reads: 
\begin{enumerate}
    \item Solve the elliptic system \eqref{63_slide_ns} to obtain \(\tilde{\uvec}^{n+1}\)
    \begin{equation}
        \begin{cases}
            \dfrac{\tilde{\uvec}^{n+1}-\uvec^n}{\tstep} -\nu\Delta \tilde{\uvec}^{n+1} + (\uvec^* \cdot \grad)\uvec^{**} = \fvec^{n+1} & \txt{in }\Omega, \\
            \tilde{\uvec}^{n+1} = \vect{0} & \txt{on }\boundary
        \end{cases}
        \label{67_slide_ns}
    \end{equation}
    \item solve the scalar elliptic problem \eqref{65_slide_ns} to obtain \(p^{n+1}\)
    \begin{equation}
        \begin{cases}
            -\Delta p^{n+1} = -\div \dfrac{\tilde{\uvec}^{n+1}}{\tstep} & \txt{in }\Omega, \\
            \displaystyle\partialderivative{p^{n+1}}{n} = 0 & \txt{on }\boundary.
        \end{cases}
        \label{68_slide_ns}
    \end{equation}
    \item obtain the corrected velocity \(\uvec^{n+1}\) thanks to the correction equation \eqref{66_slide_ns}
    \begin{equation}
        \uvec^{n+1} = \tilde{\uvec}^{n+1} - \Delta t \grad p^{n+1}
        \label{69_slide_ns}
    \end{equation}
\end{enumerate}
As with many explicit schemes, if we take \(\uvec^* = \uvec^{**} = \uvec^n\) we obtain a method that has a stability restriction on the timestep like 
\[
    \tstep \leq C \frac{h}{\max_{\xvec\in \Omega}\abs{\uvec^n(\xvec)}}.
\]
On the other hand, this system splits into independent systems of smaller size, one for each spatial component of the velocity fields.

If we decided to use \(\uvec^* = \uvec^{**} = \uvec^{n+1}\) we obtain an unconditionally stable method, but the downside is that the spatial components aren't separated due to the nonlinear convective term. 
Its algebraic formulation is of the form 
\[
    \left( \frac{1}{\tstep} M + A \right) \tilde{\uvec}^{n+1} = \tilde{\fvec}^{n+1}
\]
On the second step, we generate a divergence free solution, but there is a failure to satisfy the physical condition in the case the pressure boundary layer has a width greater than 
\[
    \sqrt{\nu \tstep}
\]