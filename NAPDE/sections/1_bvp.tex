
\section{Boundary Value Problems}
\subsection{Weak Formulation}
Let's consider a problem 
\begin{equation}
    \begin{cases}
        \mathcal{L}u = f & \text{in }\Omega \\
        + \text{B.C.} & \text{on }\partial\Omega
    \end{cases}
\end{equation}
\begin{itemize}
    \item \(\Omega\): open bounded domain in \(\real^d\), with \(d = 2,3\)
    \item \(\partial\Omega\): boundary of \(\Omega\)
    \item \(f\): given 
    \item B.C. accordingly to \(\mathcal{L}\)
    \item \(\mathcal{L}\): \(2^{\text{nd}}\) order operator, like:
    \begin{enumerate}
        \item \(\mathcal{L}u = -\div(\mu\grad u) +\vect{b}\cdot\grad u + \sigma u\) {\hspace*{\fill} (non-conservative form)}
        \item \(\mathcal{L}u = -\div(\mu \grad u) + \div(\vect{b}u) + \sigma u\) {\hspace*{\fill} (conservative form)}
    \end{enumerate}
    \begin{itemize}
        \item \(\mu \in L^\infty(\Omega), \quad \mu(\vect{x})\geq \mu_0 > 0\) {\hspace*{\fill} uniformly bounded from below}
        \item \(\vect{b} \in (L^\infty(\Omega))^d\) {\hspace*{\fill} transport term}
        \item \(\sigma \in L^2(\Omega)\) {\hspace*{\fill} reaction term}
        \item \(f \in L^2(\Omega)\) {\hspace*{\fill} can be less regular}
    \end{itemize}
\end{itemize}

%\subsection*{Example}
%Advection Diffusion Reaction Problem: 
%\begin{equation*}
%    \begin{cases}
%        Lu = \overbrace{-\div (\mu\grad u)}^{\txt{diffusion}} + \overbrace{\vect{b} \cdot \grad u}^{\txt{advection}} + \overbrace{\sigma u}^{\txt{reaction}} = f & \txt{in }\Omega \\
%        u = 0 & \txt{on }\Gamma_D\\
%        \mu \grad u \cdot \vect{n} = g & \txt{on }\Gamma_N 
%    \end{cases}
%    \qquad\qquad
%    \begin{array}{l}
%        g \in L^2(\Gamma_N) \\
%        \partial\Omega = \Gamma_D \cup \Gamma_N \\
%        \interior{\Gamma_D} \cap \interior{\Gamma_N} = \emptyset
%    \end{array}
%\end{equation*}
\subsection*{General elliptic problems}
Consider 
\begin{equation}
    \begin{cases}
        -\div(\mu \grad u)+ \vect{b}\cdot \grad u + \sigma u = f& \text{in } \Omega \\
        u = 0 & \txt{on }\Gamma_D \\
        \mu \grad u \cdot \vect{n} = g & \txt{on } \Gamma_N
    \end{cases}
    \qquad\qquad
    \begin{array}{l}
        g \in L^2(\Gamma_N) \\
        \partial\Omega = \Gamma_D \cup \Gamma_N \\
        \interior{\Gamma_D} \cap \interior{\Gamma_N} = \emptyset
    \end{array}
\end{equation}
Suppose that \(f \in L^2(\Omega)\) and \(\mu, \sigma \in L^\infty(\Omega)\). Also suppose that \(\exists \; \mu_0 > 0 \txt{ s.t. } \mu(\vect{x}) \geq \mu_0\), and \(\sigma(\vect{x}) \geq 0\) a.e. on \(\Omega\).  
Then, given a test function \(v\), we multiply the equation by \(v\), and integrate on the domain \(\Omega\)
\begin{equation*}
    \int_\Omega \left[-\div(\mu \grad u)+ \vect{b}\cdot \grad u + \sigma u\right] v \,  = \int_\Omega f v 
\end{equation*}
By applying Green's formula 
\begin{equation*}
    \underbrace{\int_\Omega \mu\grad u \cdot \grad v  + \int_\Omega \vect{b} \cdot \grad u v + \int_\Omega \sigma u v}_{=: a(u,v)} = \int_\Omega f v +\underbrace{\int_{\Gamma_D} \mu \grad u \cdot \vect{n} v}_{= 0 \txt{ if } v\vert_{\Gamma_D} = 0} + \int_{\Gamma_N} \underbrace{\mu \grad u \cdot \vect{n}}_{= g} v 
\end{equation*}
So the weak formulation of the problem is 
\begin{equation}
    \begin{cases}
        \txt{Find } u \in V & V = \left\{v \in H^1(\Omega), v\vert_{\Gamma_D} = 0\right\} =: H^1_{\Gamma_D}(\Omega)\\
        a(u,v) = \scalarproduct{F}{v} & \forall \; v \in V \label{Weak Formulation of Boundary Value Problems}
    \end{cases}
\end{equation}
where \(a: V \times V \to \real\) is a bilinear form and \(F:V \to \real\) is a linear form s.t. \(\scalarproduct{F}{v} \equiv F(v) = \int_\Omega fv + \int_{\Gamma_N} gv\).
\begin{theorem}[Lax-Milgram]
    Assume that 
    \begin{itemize}
        \item \(V\) Hilbert space with \(\normdot\) and inner product \((\cdot, \cdot)\)
        \item \(F \in V^*: \abs*{F(v)} \leq \norm*{F}_{V^*}\norm*{v} \; \forall \; v \in V\)
        \item \(a\) continuous: \(\exists \; M > 0: \abs{a(u,v)} \leq M \norm*{u}\norm*{v} \; \forall \; u,v \in V\)
        \item \(a\) coercive: \(\exists \; \alpha > 0: a(v,v) \geq \alpha\norm*{v}^2 \; \forall \; v \in V\)
    \end{itemize}
    Then, there exists a unique solution \(u\) of \ref*{Weak Formulation of Boundary Value Problems}
\end{theorem}
Moreover 
\[
    \alpha \norm*{u}^2 \leq a(u,u) = F(u) \leq \norm*{F}_{V^*} \norm*{u}
\]
where \(\alpha\) is the coercivity costant. Hence
\[
    \norm*{u} \leq \frac{\norm*{F}_{V^*}}{\alpha} \to \txt{stability/continuous dependence on data}
\]
But what if some of the assumptions of Lax-Milgram (in particular coercivity) are not satisfied?

We need a slightly more general problem to formulate Nečas theorem:
\begin{equation}
    \begin{cases}
        \txt{find } u \in V \\
        a(u,w) = \scalarproduct{F}{w} & \forall w \in W \label{Generalized weak formulation}
    \end{cases}
\end{equation}
They belong to different spaces: W for the test function, V the solutions
\begin{theorem}[Nečas]
    Assume that \(F \in W^*\). Consider the following conditions:
    \begin{itemize}
        \item \(a\) continuous: \(\exists \; M > 0: \abs*{a(u,w)} \leq M \norm*{u}_V \norm*{w}_W \; \forall \; u \in V, w \in W\)
        \item \(\inf-\sup\) condition: \(\exists \; \alpha > 0: \forall \; v \in V \quad \sup_{w \in W \setminus \left\{0\right\}} \frac{a(v,m)}{\norm*{w}_W} \geq \alpha \norm*{v}_V\)
        \item \(\forall \; w \in W, w \neq 0, \exists \; v \in V : a(v,w) \neq 0\)
    \end{itemize}
    These conditions are necessary and sufficient for the existence and uniqueness of a solution of \ref*{Generalized weak formulation}, for any \(F \in W^*\). Moreover 
    \[
        \norm*{u}_V \leq \frac{1}{\alpha}\norm*{F}_{W^*}
    \]
\end{theorem}
When \(W=V\) Lax-Milgram provides necessary and sufficient conditions for existence and uniqueness of solutions.

Going back to 
\begin{equation*}
    \begin{cases}
        \mathcal{L}u = f & \text{in }\Omega \\
        + \text{B.C.} & \text{on }\partial\Omega
    \end{cases}
\end{equation*}
What could be our choice of \(V\)? Given that
\[
    u\in V : a(u,v) = F(v) \quad \forall \; v \in V
\]
and 
\[
    a(u,v) = \int_\Omega \mu \underbrace{\grad u \grad v}_{\grad u, \grad v \in L^2} + \int_\Omega b \underbrace{\grad u v}_{\in L^1} + \int_\Omega \sigma \underbrace{u v}_{\in L^1}
\]
We want to choose \(v\) in order to have all of these integrable \[\Rightarrow V = \left\{v \in L^2(\Omega), \grad u \in \left[L^2(\Omega)\right]^d, v\vert_{\Gamma_D} = 0\right\} = V_{\Gamma_D}\].

Knowing that a Sobolev space 
\[
    H^1 = \left\{v \in L^2(\Omega), \grad u \in \left[L^2(\Omega)\right]^d\right\}
\]
we can say \(V_{\Gamma_D} = \left\{v \in H^1(\Omega): v\limited{\Gamma_D}= 0\right\}\), and if \(\Gamma_D = \partial\Omega\), then \(V_{\Gamma_D} = H^1_0\)
\subsection{Approximation}
Recall for a moment the weak formulation of a generic elliptic problem 
\begin{equation}
    \begin{cases}
        \txt{Find } u \in V \\
        a(u,v) = \scalarproduct{F}{v} & \forall \; v \in V \label{Weak Formulation of Boundary Value Problems - 2}
    \end{cases}
\end{equation}
with \(V\) being an appropriate Hilbert space, subset of \(H^1(), a(\cdot,\cdot)\) being a continuous and coercive bilinear forrm from \(V \times V \to \real\), \(F(\cdot)\) being a continuous linear functional from \(V \to \real\).

Let \(V_h \subset V\) be a family of spaces that depends on a parameter \(h > 0\), such that \(\dim V_h = N_h < \infty\).
We can rewrite the weak formulation 
\begin{equation}
    \begin{cases}
        \txt{Find } u_h \in V_h\\
        a(u_h,v_h) = \scalarproduct{F}{v_h} & \forall \; v_h \in V_h \label{Galerkin Problem Formula}
    \end{cases}
\end{equation}
and is called a \textbf{Galerkin problem}. Denoting with \(\left\{\phi_j, j = 1,2,\ldots,N_h\right\}\) a basis of \(V_h\), it is sufficient that the \eqref{Galerkin Problem Formula} is verified for each function of the basis. 
Also we need that 
\[
    a(u_h, \phi_i) = F(\phi_i) \quad i = 1, 2, \ldots , N_h
\]
Since \(u_h \in V_h\)
\[
    u_h(\vect{x})=\sum_{j=1}^{N_h} u_j \phi_j(\vect{x})
\]
where \(u_j\) are unknown coefficients. Then
\[
    \sum_{j=1}^{N_h}u_j a(\phi_j, \phi_i) = F(\phi_i)
\]
We denote by \(A\) the matrix made by \(a_{ij} = a(\phi_j, \phi_i)\) and \(\vect{f}\) the vector of \(F(\phi_i) = f_i\) components. If we denote the vector \(\vect{u}\) made by the unknown coefficients \(u_h\).
\begin{equation}
    A\vect{u} = \vect{f}
    \label{Linear system Galerkin}
\end{equation}
\begin{theorem}
    The stiffness matrix \(A\) associated to the Galerkin discretization of an elliptic problem, whose bilinear form is coercive is positive definite.
\end{theorem}
\begin{proof}
    Recall that a matrix \(B \in \real^{n\times n}\) is said to be positive definite if 
    \[
        \vect{v}^TB\vect{v} \geq 0 \quad \forall \; \vect{v} \in \real^n
    \]
    and
    \[
        \vect{v}^T B \vect{v} = 0 \Leftrightarrow \vect{v} = \vect{0}
    \]
    The correspondence 
    \[
        \vect{v} = (v_i) \in \real^{N_h} \longrightarrow v_h(x) = \sum_{j=1}^{N_h} v_j\phi_j \in V_h
    \]
    defines a bijection between \(V_h\) and \(\real^{N_h}\). Given a generic vector \(\vect{v} = (v_i)\) of \(\real^{N_h}\), thanks to the bilinearity and coercivity of \(a\) we obtain 
    \[
        \begin{array}{rl}
        \vect{v}^T A \vect{v} & = \sum_{j=1}^{N_h}\sum_{i=1}^{N_h} v_i ai_j v_j \\
        & = \sum_{j=1}^{N_h}\sum_{i=1}^{N_h} v_ia(\phi_j, \phi_i)v_j\\
        & = \sum_{j=1}^{N_h}\sum_{i=1}^{N_h} a(v_j\phi_j, v_i \phi_i)\\
        & = a\left(\sum_{j=1}^{N_h}v_j\phi_j\sum_{i=1}^{N_h}v_i\phi_i\right)\\
        & = a(v_h,v_h) \geq \alpha \norm*{v_h}_V^2 \geq 0
        \end{array}
    \]
    Moreover, if \(\vect{v}^T A \vect{v} = 0\), then \(\norm{v_h}_V^2 = 0\).
\end{proof}
\subsubsection*{Existence and uniqueness}
\begin{corollary}
    The solution of the Galerkin problem \eqref{Galerkin Problem Formula} exists and is unique.
\end{corollary}
To prove this we can prove that the solution to \eqref{Linear system Galerkin} exists and is unique. The matrix \(A\) is invertible as the unique solution of \(A\vect{u} = \vect{0}\) is the null solution, meaning that \(A\) is definite positive.
\subsection*{Stability}
\begin{corollary}
    The Galerkin method is stable, uniformly with respect to \(h\), by virtue of the following upper bound for the solution
    \[
        \norm{u_h}_V \leq \frac{1}{\alpha}\norm{F}_{V^*}
    \]
\end{corollary}
The stability of the method guarantees that the norm \(\norm{u_h}_V\) of the discrete solution remains bounded for \(h \to 0\). Equivalently it guarantees that \(\norm{u_h-w_h}_V \leq \frac{1}{\alpha}\norm{F-G}_{V^*}\) with \(u_h\) and \(w_h\) being numerical solution corresponding to different data \(F\) and \(G\).
\subsection*{Convergence}
\begin{lemma}[Galerkin orthogonality]
    The solution \(u_h\) of the Galerkin method satisfies 
    \begin{equation}
        a(u-u_h, v_h) = 0 \quad \forall \; v_h \in V_h \label{Galerkin orthogonality}
    \end{equation}
\end{lemma}
\begin{proof}
    Since \(V_h \subset V\), the exact solution \(u\) satisfies the weak problem \eqref{Weak Formulation of Boundary Value Problems - 2} for each element \(v = v_h \in V_h\), hence we have 
    \begin{equation}
        a(u, v_h) = F(v_h) \forall \; v_h \in V_h \label{Application of exact solution}
    \end{equation}
    By subtracting side by side \eqref{Galerkin Problem Formula} from \eqref{Application of exact solution}, we obtain 
    \[
        a(u,v_h)-a(u_h, v_h) = 0 \forall \; v_h \in V_h
    \]
    from which the claim follows.
\end{proof}
Also this can be generalized in the cases in which \(a(\cdot, \cdot)\) is not symmetrcic. Consider the value taken by the bilinear form when both its arguments are \(u-u_h\). If \(v_h\) is an arbitrary element of \(V_h\) we obtain 
\[
    a(u-u_h, u-u_h) = a(u-u_h, u-v_h) + a(u-u_h, v_h-u_h)
\]
The last term is null by \eqref{Galerkin orthogonality}. Moreover 
\[
    \abs*{a(u-u_h, u-v_h)} \leq M \norm{u-u_h}_V\norm{u-v_h}_V
\]
having exploited the continuity of the bilinear form. Also by the coercivity 
\[
    a(u-u_h, u-u_h) \geq \alpha \norm{u-u_h}^2_V
\]
hence 
\[
    \norm{u-u_h}_V \leq \frac{M}{\alpha} \norm{u-v_h}_V \quad \forall\; v_h \in V_h
\]
Such inequality holds for all functions \(v_h \in V_h\) and therefore we find 
\begin{equation}
   \underbrace{ \norm{u-u_h}_V}_{\text{Galerkin error}} \leq \frac{M}{\alpha} \underbrace{\inf_{w_h \in V_h} \norm{u - w_h}_V}_{\text{Best Approximation Error}} \label{Ceà Lemma}
\end{equation}
In order for the method to converge, it is sufficient that, for \(h \to 0\) the space \(V_h\) tends to saturate the entire space \(V\). 
\begin{equation}
    \lim_{h \to 0} \inf_{v_h \in V_h} \norm{v-v_h}_V= 0 \quad \forall \; v \in V \label{Saturation Property}
\end{equation}
In that case the Galerkin method is convergent and it can be written that
\[
    \lim_{h\to 0} \norm{u-u_h}_V = 0 \Leftrightarrow \text{convergence}
\]
Thie space \(V_h\) must be chosen carefully to satisfy the saturation property \eqref{Saturation Property}.
\subsection{Finite Element Method}
Let us suppose that \(\Omega\) is an interval \((a,b)\). How to create an approximation of the space \(H^1(a,b)\) that depend on a parameter \(h\). Consider a partition \(\mathcal{T}_h\) in \(N+1\) subintervals \(K_j = x_{j-1}, x_j\), having width \(h_j = x_j - x_{j-1}\) with 
\begin{equation}
    a = x_0 < x_1 < \ldots < x_{N-1} < x_N = b \label{Partition of an interval}
\end{equation}
and set \(h = \max_j h_j\). 

Since the functions of \(H^1(a,b)\) are continuous on \([a,b]\), it is possible to create the family of spaces 
\begin{equation}
    X_h^r = \left\{v_h \in C^0\left(\overline{\Omega}\right) : v_h \vert_{K_j} \in \mathbb{P}_r \;\; \forall \; K_j \in \mathcal{T}_h\right\}, \quad r= 1,2,\ldots \label{Family of spaces FEM}
\end{equation}
having denoted by \(\mathbb{P}_r\) the space of polynomials with degree lower or equal to \(r\) in the variable \(x\). All these spaces are subspaces of \(H^1(a,b)\) as they are constituted by differentiable functions except for at most a finite number of points (the vertices of the partition). 