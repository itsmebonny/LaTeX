% A LaTeX template for EXECUTIVE SUMMARY of the MSc Thesis submissions to
% Politecnico di Milano (PoliMi) - School of Industrial and Information Engineering
%
% P. F. Antonietti, S. Bonetti, A. Gruttadauria, G. Mescolini, A. Zingaro
% e-mail: template-tesi-ingind@polimi.it
%
% Last Revision: October 2021
%
% Copyright 2021 Politecnico di Milano, Italy. Inc. All rights reserved.

\documentclass[11pt,a4paper]{article}

%------------------------------------------------------------------------------
%	REQUIRED PACKAGES AND  CONFIGURATIONS
%------------------------------------------------------------------------------
% PACKAGES FOR TITLES
\usepackage{titlesec}
\usepackage{color}
% PACKAGES FOR LANGUAGE AND FONT
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc} % Font encoding
\usepackage{lmodern} % Latin Modern font
% PACKAGES FOR IMAGES
\usepackage{graphicx}
\graphicspath{{Images/}} % Path for images' folder
\usepackage{eso-pic} % For the background picture on the title page
\usepackage{subfig} % Numbered and caption subfigures using \subfloat
\usepackage{caption} % Coloured captions
%\usepackage{subcaption}
\usepackage{transparent}


% STANDARD MATH PACKAGES
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage[overload]{empheq}  % For braced-style systems of equations

% PACKAGES FOR TABLES
\usepackage{tabularx}
\usepackage{longtable} % tables that can span several pages
\usepackage{colortbl}

% PACKAGES FOR ALGORITHMS (PSEUDO-CODE)
\usepackage{algorithm}
\usepackage{algpseudocode}
% PACKAGES FOR REFERENCES & BIBLIOGRAPHY
\usepackage{biblatex} %Imports biblatex package, specify biber backend
\addbibresource{mimesis.bib}
\usepackage[colorlinks=true,linkcolor=black,anchorcolor=black,citecolor=black,filecolor=black,menucolor=black,runcolor=black,urlcolor=black]{hyperref} % Adds clickable links at references
\usepackage{cleveref}
%\usepackage[square, numbers, sort&compress]{natbib} % Square brackets, citing references with numbers, citations sorted by appearance in the text and compressed
\usepackage{bookmark} % Add this package to fix the reported errors
% \bibliographystyle{plain} % You may use a different style adapted to your field
% \bibliographystyle{plain} % You may use a different style adapted to your field

% PACKAGES FOR THE APPENDIX

\usepackage{appendix}

% PACKAGES FOR ITEMIZE & ENUMERATES
\usepackage{enumitem}

% OTHER PACKAGES
\usepackage{amsthm,thmtools,xcolor} % Coloured "Theorem"
\usepackage{comment} % Comment part of code
\usepackage{fancyhdr} % Fancy headers and footers
\usepackage{lipsum} % Insert dummy text
\usepackage{tcolorbox} % Create coloured boxes (e.g. the one for the key-words)
\usepackage{stfloats} % Correct position of the tables
\usepackage{multirow}
\usepackage{multicol}






%-------------------------------------------------------------------------
%	NEW COMMANDS DEFINED
%-------------------------------------------------------------------------
% EXAMPLES OF NEW COMMANDS -> here you see how to define new commands
\newcommand{\bea}{\begin{eqnarray}} % Shortcut for equation arrays
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\e}[1]{\times 10^{#1}}  % Powers of 10 notation
\newcommand{\mathbbm}[1]{\text{\usefont{U}{bbm}{m}{n}#1}} % From mathbbm.sty
\newcommand{\pdev}[2]{\frac{\partial#1}{\partial#2}}
% NB: you can also override some existing commands with the keyword \renewcommand

%----------------------------------------------------------------------------
%	ADD YOUR PACKAGES (be careful of package interaction)
%----------------------------------------------------------------------------
\usepackage{amsfonts} 
\usepackage[font=footnotesize,labelfont=bf]{caption}
\usepackage{placeins} % in your preamble


%----------------------------------------------------------------------------
%	ADD YOUR DEFINITIONS AND COMMANDS (be careful of existing commands)
%----------------------------------------------------------------------------
\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{wrapfig}
\usepackage{dsfont}
\usepackage{shadethm}
\usepackage{tikz}
\def\layersep{2.5cm}

\parindent=0pt

\newcommand{\incfig}[1]{%
    \def\svgwidth{\columnwidth}
    \import{./Images/}{#1.pdf_tex}
}
\newcommand*{\oldepsilon}{\epsilon}
\renewcommand*{\epsilon}{\varepsilon}
\newcommand*{\oldphi}{\phi}
\renewcommand*{\phi}{\varphi}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\numberwithin{equation}{section}
%----------------------------------------------------------------------------
%	CONFIGURATION OF THEOREM ENVIRONMENTS


% \newtheoremstyle{break}
%     {\partopsep}{\topsep}%  
%     {\normalfont}{}
%     {\bfseries}{}%
%     {\newline}{}%
% \theoremstyle{break}
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{corollary}{Corollary}[section]
% \newtheorem{proposition}{Proposition}[section]
% \newtheorem{remark}{Remark}[section]
% \newtheorem{lemma}{Lemma}[section]
% \newtheorem{notation}{Notation}[section]
% \newtheorem{definition}{Definition}[section]

% \newtheorem{definition}{Definition}[section]

% \newtheorem*{remark}{Remark}

% \newtheorem{lemma}{Lemma}[section]
% %----------------------------------------------------------------------------

% Do not change Configuration_files/config.tex file unless you really know what you are doing.
% This file ends the configuration procedures (e.g. customizing commands, definition of new commands)
\input{Configuration_files/config}

% Insert here the info that will be displayed into your Title page
% -> title of your work
\renewcommand{\title}{\noindent A Modified Neural Modes Approach for Soft Tissue Simulation}


% -> author name and surname
\renewcommand{\author}{Andrea Bonifacio}
% -> student ID
\newcommand{\ID}{217658} % insert your student ID here
% -> MSc course
\newcommand\norm[1]{\lVert#1\rVert}
\newcommand{\course}{Mathematical Engineering - Ingegneria Matematica}
% -> advisor name and surname
\newcommand{\advisor}{Prof. Stefano Pagani}
% IF AND ONLY IF you need to modify the co-supervisors you also have to modify the file Configuration_files/title_page.tex (ONLY where it is marked)
\newcommand{\firstcoadvisor}{Dr. Stéphane Cotin} % insert if any otherwise comment
%\newcommand{\secondcoadvisor}{Name Surname} % insert if any otherwise comment
% -> academic year
\newcommand{\YEAR}{2024-2025}

\renewcommand{\abstract}{This work addresses the computational challenges inherent in simulating the dynamic, nonlinear deformation of soft tissues, particularly when using traditional Finite Element Methods (FEM). We investigate the efficiency and accuracy of a method, named ``Neural Modes'' and then build upon their ideas, to obtain a simulation framework that combines the computation of the energy during the training of the network, keeping the physics-informed loss function, with a supervised learning strategy that allows the network to learn nonlinear corrections for large deformations. 
The core of the method trains a deep neural network to learn nonlinear corrections to a reduced-order linear modal basis. This approach not only accelerates simulations by operating in a reduced-dimensional space but also enhances the interpretability of the learned model, as the corrections are applied to physically meaningful linear modes. The efficacy of the Neural Modes framework is demonstrated through numerical experiments on some 3D benchmark problems, showcasing its potential for applications in biomechanics and surgical simulation where both speed and accuracy are fundamental.
}

\newcommand{\abstractita}{Questa tesi affronta le sfide computazionali inerenti alla simu-
lazione della deformazione dinamica e non lineare dei tessuti molli, in particolare quando si utilizzano
metodi tradizionali agli elementi finiti (FEM). Si studia l'efficienza e la accuratezza di un metodo, denominato “Neural Modes”, e si sviluppa a partire da quest'ultimo per ottenere un quadro di simulazione che combina il calcolo dell'energia durante
l'addestramento della rete, mantenendo le informazioni derivanti dalla fisica nella funzione obiettivo, con una
strategia di apprendimento supervisionato che consente alla rete di apprendere correzioni non lineari per
grandi deformazioni. Il nucleo del metodo addestra una rete neurale profonda per apprendere
correzioni non lineari rispetto a una base modale lineare di ordine ridotto. Questo approccio non
solo accelera le simulazioni operando in uno spazio di minore dimensione, ma
migliora anche l'interpretabilità del modello, poiché le correzioni sono applicate
a modalità lineari fisicamente significativi. L'efficacia del lavoro di Neural Modes
è dimostrata attraverso esperimenti numerici su alcuni problemi di riferimento in 3D,
mostrando il suo potenziale per applicazioni nella biomeccanica e nella simulazione chirurgica
dove sia la velocità che la precisione sono fondamentali.
}


% -> key-words (only in English)
\newcommand{\keywords}{Finite Element Method, Neural Networks, Model Order Reduction, Soft Tissue Simulation, Hyperelastic Materials}

\newcommand{\keywordsita}{Metodi agli Elementi Finiti, Reti Neurali, Modelli a Ordine Ridotto, Simulazione Tessuti Molli, Materiali Iperelastici}


%-------------------------------------------------------------------------
%	BEGIN OF YOUR DOCUMENT

\begin{document}
%-----------------------------------------------------------------------------
% TITLE PAGE
%-----------------------------------------------------------------------------
% Do not change Configuration_files/TitlePage.tex (Modify it IF AND ONLY IF you need to add or delete the Co-advisors)
% This file creates the Title Page of the document
\input{Configuration_files/title_page}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     THESIS MAIN TEXT     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%-----------------------------------------------------------------------------
% INTRODUCTION
%-----------------------------------------------------------------------------

\input{Sections/01_introduction}

\input{Sections/02_Problem_setting.tex}

\input{Sections/03_Neural_Network.tex}

\input{Sections/04_numerical_results.tex}



%-----------------------------------------------------------------------------
% CONCLUSION
%-----------------------------------------------------------------------------

\section{Conclusion}
\label{sec:conclusion}
In this work, we have explored the Neural Modes framework, which combines the strengths of linear modal analysis and deep learning to simulate the nonlinear deformation of objects. After a careful analysis of the original method and developing an implementation that allowed us to test this method with the aid of SOFA as a numerical solver, we have identified some limitations of the original method, such as the limited range of deformations that can be accurately captured with the self-supervised training approach and the sampling of the latent space. To address these limitations in our use case, we have proposed a modified version of the Neural Modes framework that incorporates a supervised learning strategy, that uses a minimal amount of data to train the network, coupled with a loss function that includes the physics-informed energy term. This approach allows the network to generalize even to large deformations with a small amount of data needed and allows to use a reduced order model to compute a full FEM simulation, which is crucial for real-time applications. The results of our numerical experiments demonstrate the effectiveness of the modified Neural Modes framework in accurately capturing the nonlinear deformation of objects, even in the presence of large deformations. 


\subsection{Computational Considerations and Performance}
Our implementation demonstrates significant computational advantages over traditional nonlinear FEM approaches. The reduction from thousands of degrees of freedom to a handful of modal coordinates (typically 7-20 modes) represents a substantial decrease in computational complexity. This dimensionality reduction, combined with the neural network's ability to capture nonlinear corrections efficiently, enables real-time simulation of complex deformation scenarios that would otherwise require significant computational resources.

The training phase, while requiring initial investment in data generation and network optimization, needs to be performed only once for a given geometry and material configuration. Once trained, the network provides instantaneous corrections to linear modal predictions, making it highly suitable for interactive applications. The memory footprint of the trained network is minimal compared to storing high-resolution FEM solutions, making deployment feasible even on resource-constrained platforms.

\subsection{Limitations and Future Directions}
Despite the promising results, several limitations merit attention and suggest directions for future research. The current framework's dynamic simulation accuracy, while maintaining energy conservation, shows some deviation from ground truth displacement fields over extended time periods. Future work could explore more sophisticated temporal integration schemes or adaptive optimization strategies to improve long-term stability.

The modal force generation approach, while physically meaningful, represents a simplified loading scenario. Real-world applications often involve more complex, time-varying force patterns that may not align perfectly with the modal basis. Developing more robust force generation strategies or extending the framework to handle arbitrary external forces would significantly broaden its applicability.

As described in \cite{Andersson_2021}, another promising direction for this work could be to completely modify the dynamics of the system, by using a fully reduced dynamic model, where we obtain \(\left[M\right]\) and \(\left[K\right]\) matrices that we obtain reducing the original matrices \(M\) and \(K\) with respect to the modal basis
\begin{equation}
    \left[M\right] = \left[\Phi\right]^T M \left[\Phi\right], \quad \left[K\right] = \left[\Phi\right]^T K \left[\Phi\right],
\end{equation}
where \(\left[\Phi\right]\) is the matrix of the modal basis. Then, projecting the displacement field \(\mathbf{u}\) onto the modal basis, we obtain the reduced displacement field \(\mathbf{q} = \left[\Phi\right]^T \mathbf{u}\). The reduced dynamic system can then be written as
\begin{equation}
    \left[{M}\right] \ddot{\mathbf{q}} + \left[{K}\right] \mathbf{q} = \mathbf{f},
\end{equation}
which can be solved using standard numerical methods and provide a more efficient way to obtain the trajectory of the system in the reduced space. Due to time constraints and software limitations, we were not able to explore this direction in this work, but it would be a natural extension of this framework. This would remove the use of a cost function that is optimized using a quasi-Newton method, which tend to accumulate numerical errors over time, and using a full dynamic model would allow to use a more robust numerical integration scheme, keeping the accuracy of the simulation higher.


\subsection{Final Remarks}
This framework represents a significant step toward bridging the gap between computational efficiency and simulation accuracy in nonlinear mechanics. By leveraging the interpretability of modal analysis and the expressiveness of neural networks, we have demonstrated a method that maintains physical consistency while achieving computational performance suitable for real-time applications.

The success of this approach highlights the broader potential of physics-informed machine learning in computational science. Rather than replacing traditional numerical methods entirely, the integration of machine learning techniques with established physical principles offers a path toward more efficient and accurate simulation tools. This paradigm could be extended to other areas of computational physics where similar trade-offs between accuracy and efficiency exist.

As we move forward, the ongoing development of these hybrid approaches will likely become increasingly important for enabling new applications that demand both accurate physics and real-time performance. The Neural Modes framework lays a foundation for this, showing that well-designed machine learning can improve, rather than replace, core physical modeling principles.
%---------------------------------------------------------------------------
%  BIBLIOGRAPHY
%---------------------------------------------------------------------------
\newpage
\printbibliography
% Remember to insert here only the essential bibliography of your work
% automatically inserted and ordered with this command

\newpage
\textbf{Abstract italiano:} \abstractita

\begin{tcolorbox}[arc=0pt, boxrule=0pt, colback=bluePoli!60, width=\textwidth, colupper=white]
        \textbf{Parole chiave:} \keywordsita
    \end{tcolorbox}

\end{document}

