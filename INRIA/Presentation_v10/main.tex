\documentclass{beamer}
\usetheme{Pittsburgh}
\beamertemplatenavigationsymbolsempty


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm} % For bold math symbols
\usepackage{graphicx}
\usepackage{tikz}



\usepackage{subfig} % Changed from subfigure (deprecated)
\usepackage{multirow}
\usepackage{multicol}
\usepackage{color}
\usepackage{url}
\usepackage{hyperref}
\usepackage{listings}
\usepackage[noend]{algorithm}
\usepackage{physics} 
% add image path
\graphicspath{{../Images/}}






\DeclareMathOperator{\argmin}{argmin}
\DeclareMathOperator{\argmax}{argmax}






\title{Weekly Updates\\
\tiny{Wednesday, 12/03/2025}}
\author{Andrea Bonifacio}
\date{}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\begin{frame}{Recap: Project Goals \& Status}
    \begin{itemize}
        \item Here's a brief recap of what we did up until now.
        \item In the first half of this project we started implementing a method that uses neural networks to compute the nonlinear correction of the displacement field.
        \item The idea was interesting, with some already existing methods in the field of CFD, but at some point we realized that the method was not easily applicable to our case, especially for the dynamic case.
        \item We decided to explore a different method, which is based on the idea of using a neural network to ``correct'' the linear modes of a structure.
    \end{itemize}
\end{frame}

\begin{frame}{Overview of Work Done}
    \begin{itemize}
        \item While the first part of the project was not very successful, helped us a lot to understand the problem and create the necessary tools to implement the new method.
        \item We learned the limitations and strengths of the numerical solver we are using (SOFA).
        \item The main idea is still to somehow correct a displacement field, but this new method is based on a self-supervised approach, removing the need for a dataset.
    \end{itemize}
\end{frame}

\begin{frame}{Neural Modes Paper - Key Ideas}
    \begin{itemize}
        \item The paper wants to extend the concept of linear modes to ``neural modes''.
        \item The idea is to compute a non-linear correction of the displacement field, by having the network minimize the energy of the system.
        \item Once the network has been trained and learned the non-linear modes for any modal coordinate in the subspace, it can be extended to dynamics by using a finite difference scheme.
    \end{itemize}
\end{frame}



\begin{frame}{Neural Modes Paper - Our Implementation}
    \begin{itemize}
        \item We developed a fully differentiable energy calculator for both StVenant-Kirchhoff and Neo-Hookean materials, completely written in PyTorch, that helps with the training speed.
        \item Most of the deformation is already captured by the linear modes (the nonlinear correction is small, around 1\%).
        \item I am having problem with changing the material properties during the simulation.
    \end{itemize}
\end{frame}


\begin{frame}{Detailed Progress: Task/Area 1}
    \frametitle{Detailed Progress: [Specific Task/Area 1 Name]}
    \begin{itemize}
        \item What was the specific goal for this task?
        \item What actions were taken?
        \item Key results or developments.
        \item (Include figures, equations, or code snippets if relevant)
    \end{itemize}
\end{frame}

\begin{frame}{Detailed Progress: Task/Area 2}
    \frametitle{Detailed Progress: [Specific Task/Area 2 Name]}
    \begin{itemize}
        \item What was the specific goal for this task?
        \item What actions were taken?
        \item Key results or developments.
        \item (Include figures, equations, or code snippets if relevant)
    \end{itemize}
\end{frame}

\begin{frame}{Detailed Progress: Task/Area 3 (Optional)}
    \frametitle{Detailed Progress: [Specific Task/Area 3 Name]}
    \begin{itemize}
        \item What was the specific goal for this task?
        \item What actions were taken?
        \item Key results or developments.
        \item (Include figures, equations, or code snippets if relevant)
    \end{itemize}
\end{frame}

\begin{frame}{Key Findings \& Learnings}
    \begin{itemize}
        \item What are the most important insights gained during this period?
        \item Any unexpected results or discoveries?
        \item How have these findings influenced the project direction?
    \end{itemize}
\end{frame}

\begin{frame}{Challenges Encountered \& Solutions Explored}
    \begin{itemize}
        \item What major obstacles or difficulties did you face?
        \item How did you attempt to overcome them?
        \item Were the solutions successful? What was learned from these challenges?
    \end{itemize}
\end{frame}

\begin{frame}{Current Status \& Next Steps}
    \begin{itemize}
        \item Where does the project stand right now?
        \item What are the immediate next steps for the coming weeks?
        \item Any adjustments to the original plan based on recent work?
        \item Long-term outlook (if applicable).
    \end{itemize}
\end{frame}

\begin{frame}{Points for Discussion / Questions for Supervisor}
    \begin{itemize}
        \item Specific areas where you need input or guidance.
        \item Questions about project direction or specific problems.
        \item Any decisions that need to be made.
    \end{itemize}
\end{frame}



\begin{frame}{Neural Modes Paper - Critical Review}
    \begin{itemize}
        \item After implementing both StVenant-Kirchhoff and Neo-Hookean materials, I realized that this method works well for small deformations.
        \item Most of the deformation is already captured by the linear modes (the nonlinear correction is small, around 1\%).
        \item I am having problem with changing the material properties during the simulation.
    \end{itemize}
\end{frame}


\begin{frame}
    \frametitle{Network Architecture}
    \begin{itemize}
        \item The network is a feedforward neural network.
        \item The input is the modal coordinate \( z \in \mathbb{R}^m \).
        \item The output is a correction on the displacement field \( \mathbf{y} \in \mathbb{R}^n \).
    \end{itemize}



\begin{center}
        
        \begin{tikzpicture}
            % Modal coordinate (z)
            \draw[fill=green!20] (-3, 1) rectangle (-2.5,2);
            \node at (-2.75, 1.5) {$z$}; % Label inside the rectangle
            
            % Displacement (u)
            \draw[fill=green!20] (2.5,0) rectangle (3,3);
            \node at (2.75, 1.5) {$y$}; % Label inside the rectangle
            
            % Energy loss transition
            \draw[fill=blue!60,opacity=0.8] (-2,1) -- (2,-0) -- (2,3) -- (-2,2) -- cycle;
            \node[below] at (0,-1) {\textbf{Energy loss}};
            
            % Energy loss arrow
            \draw[thick,blue,->] (-2,-0.8) -- (2,-0.8);
        
        \end{tikzpicture}
\end{center}
    
\end{frame}

\begin{frame}
    \frametitle{Training the network}
    \begin{itemize}
        \item At each iteration, the network is trained on a batch of modal coordinates randomly selected.
        \item Four loss functions are used:
        \begin{itemize}
            \item Energy loss: \( E(X + l + y)\), where \(X\) is the rest position, \(l\) is the linear mode given by \(z\) and \(y\) is the nonlinear correction.
            \item Orthogonality loss: \( y^T l = 0 \).
            \item Origin loss: \( y(0) = 0 \).
        \end{itemize}
        \item The network is trained by minimizing the weighted sum of these losses.
        \[
        \text{Loss} = \text{Energy } + \lambda_1 \text{Orthogonality } + \lambda_2 \text{Origin}
        \]
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Visualization}
    \begin{figure}
        \centering
        \includegraphics[scale=0.15]{Images/image.png}
        \caption{Nonlinear latent space.}
    \end{figure}
\end{frame}

\begin{frame}
    \frametitle{Dynamic simulation}
    I started implementing it, but the optimization problem takes too long to solve.
    \begin{itemize}
        \item The optimization problem is solved using the L-BFGS-B algorithm. (As in the paper)
        \item Each iteration takes around 3-4 seconds.
        \item Maybe another optimization algorithm could be used?
    \end{itemize}
    \begin{itemize}
        \item The non-linear correction can be computed by:
        \[
        z_{n+1} = \underset{z}{\argmin}  \frac{1}{2h^2} \norm{n(z) - 2u_n + u_{n-1}}^2_M + E(n(z))
        \]
        \item Here \(n(z)\) is the non-linear correction computed by the network, and \(M\) is the mass matrix.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{What now?}
    \begin{itemize}
        \item What is our goal?
        \item Are there similar methods? There are some papers on strain modes from the same authors.
        \item In the same paper they mention a Rotation-Strain decomposition. Could be useful?
        \item Learn how to do simulations correctly
    
    \end{itemize}
\end{frame}

% Q&A
\begin{frame}
    \begin{center}
        \color{blue} \Huge{Questions?}
    \end{center}

\end{frame}
\end{document}

